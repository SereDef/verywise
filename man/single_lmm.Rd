% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/run_vw_lmm.R
\name{single_lmm}
\alias{single_lmm}
\title{Run a single linear mixed model and extract statistics}
\usage{
single_lmm(
  imp,
  y,
  formula,
  model_template = NULL,
  pvalues = TRUE,
  weights = NULL,
  lmm_control = lme4::lmerControl()
)
}
\arguments{
\item{imp}{A data.frame containing the phenotype dataset
(in verywise format).}

\item{y}{A numeric vector of outcome values representing a single
vertex from the super-subject matrix.}

\item{formula}{An R formula object describing the linear mixed model using
\code{lme4} notation.}

\item{model_template}{Optional pre-compiled model object for faster
estimation. When provided, \code{single_lmm} will use an "update"-based
workflow instead of refitting the model from scratch. This minimizes
repeated parsing and model construction overhead, significantly reducing
computation time for large-scale vertex-wise analyses.
Default: \code{NULL}.}

\item{pvalues}{Logical indicating whether to compute p-values using the
*t-as-z* approximation (see Details). Default: \code{TRUE}.}

\item{weights}{Optional numeric vector of weights for the linear mixed model.
You can use this argument to specify inverse-probability weights.
Note that these are not normalized or standardized in any way.
Default: \code{NULL} (no weights).}

\item{lmm_control}{Optional list (of correct class, resulting from
\code{lmerControl()} containing control parameters to be passed to
\code{lme4::lmer()} (e.g. optimizer choice, convergence criteria,
see the \code{*lmerControl} documentation for details.
Default: (uses default settings).}
}
\value{
A list with two elements:
  \itemize{
    \item \code{stats} - A data.frame with columns:
      \itemize{
        \item \code{term} - Fixed effect term names
        \item \code{qhat} - Parameter estimates
        \item \code{se} - Standard errors
        \item \code{tval} - t-statistics (if \code{pvalues = TRUE})
        \item \code{pval} - p-values (if \code{pvalues = TRUE})
      }
    \item \code{resid} - A numeric vector of model residuals
  }
}
\description{
Fits a linear mixed model to a single vertex outcome using
\code{lme4::lmer()} and extracts fixed effects statistics. This function
is called repeatedly across all cortical vertices during vertex-wise
analysis.
}
\details{
No additional parameters are currently passed to the \code{lme4::lmer} call.
P-values are estimated using the *t-as-z* approach. This is known
to the anti-conservative for small sample sizes.sizes but provides a
computationally efficient solution. Type I error control is addressed
more rigorously at the cluster-forming stage.
}
\seealso{
\code{\link{run_vw_lmm}} for the main interface.
}
