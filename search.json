[{"path":"https://seredef.github.io/verywise/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"Apache License","title":"Apache License","text":"Version 2.0, January 2004 <http://www.apache.org/licenses/>","code":""},{"path":[]},{"path":"https://seredef.github.io/verywise/LICENSE.html","id":"id_1-definitions","dir":"","previous_headings":"Terms and Conditions for use, reproduction, and distribution","what":"1. Definitions","title":"Apache License","text":"“License” shall mean terms conditions use, reproduction, distribution defined Sections 1 9 document. “Licensor” shall mean copyright owner entity authorized copyright owner granting License. “Legal Entity” shall mean union acting entity entities control, controlled , common control entity. purposes definition, “control” means () power, direct indirect, cause direction management entity, whether contract otherwise, (ii) ownership fifty percent (50%) outstanding shares, (iii) beneficial ownership entity. “” (“”) shall mean individual Legal Entity exercising permissions granted License. “Source” form shall mean preferred form making modifications, including limited software source code, documentation source, configuration files. “Object” form shall mean form resulting mechanical transformation translation Source form, including limited compiled object code, generated documentation, conversions media types. “Work” shall mean work authorship, whether Source Object form, made available License, indicated copyright notice included attached work (example provided Appendix ). “Derivative Works” shall mean work, whether Source Object form, based (derived ) Work editorial revisions, annotations, elaborations, modifications represent, whole, original work authorship. purposes License, Derivative Works shall include works remain separable , merely link (bind name) interfaces , Work Derivative Works thereof. “Contribution” shall mean work authorship, including original version Work modifications additions Work Derivative Works thereof, intentionally submitted Licensor inclusion Work copyright owner individual Legal Entity authorized submit behalf copyright owner. purposes definition, “submitted” means form electronic, verbal, written communication sent Licensor representatives, including limited communication electronic mailing lists, source code control systems, issue tracking systems managed , behalf , Licensor purpose discussing improving Work, excluding communication conspicuously marked otherwise designated writing copyright owner “Contribution.” “Contributor” shall mean Licensor individual Legal Entity behalf Contribution received Licensor subsequently incorporated within Work.","code":""},{"path":"https://seredef.github.io/verywise/LICENSE.html","id":"id_2-grant-of-copyright-license","dir":"","previous_headings":"Terms and Conditions for use, reproduction, and distribution","what":"2. Grant of Copyright License","title":"Apache License","text":"Subject terms conditions License, Contributor hereby grants perpetual, worldwide, non-exclusive, -charge, royalty-free, irrevocable copyright license reproduce, prepare Derivative Works , publicly display, publicly perform, sublicense, distribute Work Derivative Works Source Object form.","code":""},{"path":"https://seredef.github.io/verywise/LICENSE.html","id":"id_3-grant-of-patent-license","dir":"","previous_headings":"Terms and Conditions for use, reproduction, and distribution","what":"3. Grant of Patent License","title":"Apache License","text":"Subject terms conditions License, Contributor hereby grants perpetual, worldwide, non-exclusive, -charge, royalty-free, irrevocable (except stated section) patent license make, made, use, offer sell, sell, import, otherwise transfer Work, license applies patent claims licensable Contributor necessarily infringed Contribution(s) alone combination Contribution(s) Work Contribution(s) submitted. institute patent litigation entity (including cross-claim counterclaim lawsuit) alleging Work Contribution incorporated within Work constitutes direct contributory patent infringement, patent licenses granted License Work shall terminate date litigation filed.","code":""},{"path":"https://seredef.github.io/verywise/LICENSE.html","id":"id_4-redistribution","dir":"","previous_headings":"Terms and Conditions for use, reproduction, and distribution","what":"4. Redistribution","title":"Apache License","text":"may reproduce distribute copies Work Derivative Works thereof medium, without modifications, Source Object form, provided meet following conditions: () must give recipients Work Derivative Works copy License; (b) must cause modified files carry prominent notices stating changed files; (c) must retain, Source form Derivative Works distribute, copyright, patent, trademark, attribution notices Source form Work, excluding notices pertain part Derivative Works; (d) Work includes “NOTICE” text file part distribution, Derivative Works distribute must include readable copy attribution notices contained within NOTICE file, excluding notices pertain part Derivative Works, least one following places: within NOTICE text file distributed part Derivative Works; within Source form documentation, provided along Derivative Works; , within display generated Derivative Works, wherever third-party notices normally appear. contents NOTICE file informational purposes modify License. may add attribution notices within Derivative Works distribute, alongside addendum NOTICE text Work, provided additional attribution notices construed modifying License. may add copyright statement modifications may provide additional different license terms conditions use, reproduction, distribution modifications, Derivative Works whole, provided use, reproduction, distribution Work otherwise complies conditions stated License.","code":""},{"path":"https://seredef.github.io/verywise/LICENSE.html","id":"id_5-submission-of-contributions","dir":"","previous_headings":"Terms and Conditions for use, reproduction, and distribution","what":"5. Submission of Contributions","title":"Apache License","text":"Unless explicitly state otherwise, Contribution intentionally submitted inclusion Work Licensor shall terms conditions License, without additional terms conditions. Notwithstanding , nothing herein shall supersede modify terms separate license agreement may executed Licensor regarding Contributions.","code":""},{"path":"https://seredef.github.io/verywise/LICENSE.html","id":"id_6-trademarks","dir":"","previous_headings":"Terms and Conditions for use, reproduction, and distribution","what":"6. Trademarks","title":"Apache License","text":"License grant permission use trade names, trademarks, service marks, product names Licensor, except required reasonable customary use describing origin Work reproducing content NOTICE file.","code":""},{"path":"https://seredef.github.io/verywise/LICENSE.html","id":"id_7-disclaimer-of-warranty","dir":"","previous_headings":"Terms and Conditions for use, reproduction, and distribution","what":"7. Disclaimer of Warranty","title":"Apache License","text":"Unless required applicable law agreed writing, Licensor provides Work (Contributor provides Contributions) “” BASIS, WITHOUT WARRANTIES CONDITIONS KIND, either express implied, including, without limitation, warranties conditions TITLE, NON-INFRINGEMENT, MERCHANTABILITY, FITNESS PARTICULAR PURPOSE. solely responsible determining appropriateness using redistributing Work assume risks associated exercise permissions License.","code":""},{"path":"https://seredef.github.io/verywise/LICENSE.html","id":"id_8-limitation-of-liability","dir":"","previous_headings":"Terms and Conditions for use, reproduction, and distribution","what":"8. Limitation of Liability","title":"Apache License","text":"event legal theory, whether tort (including negligence), contract, otherwise, unless required applicable law (deliberate grossly negligent acts) agreed writing, shall Contributor liable damages, including direct, indirect, special, incidental, consequential damages character arising result License use inability use Work (including limited damages loss goodwill, work stoppage, computer failure malfunction, commercial damages losses), even Contributor advised possibility damages.","code":""},{"path":"https://seredef.github.io/verywise/LICENSE.html","id":"id_9-accepting-warranty-or-additional-liability","dir":"","previous_headings":"Terms and Conditions for use, reproduction, and distribution","what":"9. Accepting Warranty or Additional Liability","title":"Apache License","text":"redistributing Work Derivative Works thereof, may choose offer, charge fee , acceptance support, warranty, indemnity, liability obligations /rights consistent License. However, accepting obligations, may act behalf sole responsibility, behalf Contributor, agree indemnify, defend, hold Contributor harmless liability incurred , claims asserted , Contributor reason accepting warranty additional liability. END TERMS CONDITIONS","code":""},{"path":"https://seredef.github.io/verywise/LICENSE.html","id":"appendix-how-to-apply-the-apache-license-to-your-work","dir":"","previous_headings":"","what":"APPENDIX: How to apply the Apache License to your work","title":"Apache License","text":"apply Apache License work, attach following boilerplate notice, fields enclosed brackets [] replaced identifying information. (Don’t include brackets!) text enclosed appropriate comment syntax file format. also recommend file class name description purpose included “printed page” copyright notice easier identification within third-party archives.","code":"Copyright [yyyy] [name of copyright owner]  Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance with the License. You may obtain a copy of the License at    http://www.apache.org/licenses/LICENSE-2.0  Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License."},{"path":"https://seredef.github.io/verywise/articles/00-installation-sys-requirements.html","id":"installation","dir":"Articles","previous_headings":"","what":"Installation","title":"Getting ready, step 1: Installation and system requirements","text":"can install development version verywise GitHub. : may need install devtools package first (already installed). also download R packages needed, give little minute. Finally, can attach package make easier use, like :","code":"# Install devtools (if not there yet) if (!requireNamespace(\"devtools\"))   install.packages('devtools')  # Install verywise devtools::install_github(\"SereDef/verywise\") library(verywise) #> Welcome, verywise user! #> This is version: 1.2.1 #> For questions, issues, and bug reports, please see https://github.com/SereDef/verywise"},{"path":"https://seredef.github.io/verywise/articles/00-installation-sys-requirements.html","id":"system-and-software-requirements","dir":"Articles","previous_headings":"","what":"System and software requirements","title":"Getting ready, step 1: Installation and system requirements","text":"order verywise run smoothly, need: R (version >= 4.1) installed (Dah!). Unix system: verywise works Mac Linux distributions, Windows. currently rely functions FreeSurfer suite require Unix/Mac. FreeSurfer installed.","code":""},{"path":"https://seredef.github.io/verywise/articles/00-installation-sys-requirements.html","id":"installing-and-setting-up-freesurfer","dir":"Articles","previous_headings":"System and software requirements","what":"Installing and setting up FreeSurfer","title":"Getting ready, step 1: Installation and system requirements","text":"TODO","code":""},{"path":"https://seredef.github.io/verywise/articles/01-format-data.html","id":"a-verywise-input-directory-structure","dir":"Articles","previous_headings":"","what":"A verywise input directory structure","title":"Getting ready, step 2: formatting input data","text":"example typical verywise input directory:  also see use data simulation functions. phenotype file need inside folder neuroimaging data, placed keep things tidy. one neuroimaging site (“cohort” dataset, however want call ), site ’s folder. Inside site folder one sub-folder individual measurement (“session”). sub-folders follow BIDS convention, example: sub-47_ses-03 3rd measurement subject #47. done automatically FreeSurfer (see next session)","code":""},{"path":"https://seredef.github.io/verywise/articles/01-format-data.html","id":"preparing-your-brain-data","dir":"Articles","previous_headings":"","what":"Preparing your brain data","title":"Getting ready, step 2: formatting input data","text":"obtain brain surface data, first run subjects FreeSurfer, using following command: Don’t forget -qcache flag! Full instructions can found , header “pre-smoothed fsaverage surfaces”. output folder now look similar one seen . Inside subject-session sub-folder able find “surf” directory brain surface maps hemisphere saved .mgh files. files using analysis.","code":"recon-all -s <subject-id> -qcache"},{"path":"https://seredef.github.io/verywise/articles/01-format-data.html","id":"preparing-your-phenotype-data","dir":"Articles","previous_headings":"","what":"Preparing your phenotype data","title":"Getting ready, step 2: formatting input data","text":"brain data sorted, also need prepare “phenotype” dataset store variables interest (.e. exposures covariates). can either saved file (e.g., .rds .csv), can R data.frame already loaded memory. Either way, look something like : “long format” different timepoints/groups stacked row-wise. folder_id column important used link phenotype correct brain data file. … TODO Note phenotype file/data object can also imputed dataset. verywise currently supports several mi dataset formats, including outputs mice, mi, amelia… TODO","code":""},{"path":"https://seredef.github.io/verywise/articles/02-simulate-data.html","id":"data-poor-simulate-yourself-some-data-son","dir":"Articles","previous_headings":"","what":"Data poor? Simulate yourself some data, son","title":"Optional: simulating data","text":"eager get started verywise access dataset (yet), can generate set ready-made FreeSurfer surface data files phenotype file go . simulated dataset already saved verywise structure.","code":"library(verywise) #> Welcome, verywise user! #> This is version: 1.2.1 #> For questions, issues, and bug reports, please see https://github.com/SereDef/verywise"},{"path":"https://seredef.github.io/verywise/articles/02-simulate-data.html","id":"only-generate-the-brain-data","dir":"Articles","previous_headings":"","what":"Only generate the brain data","title":"Optional: simulating data","text":"phenotype dataset already, missing FreeSurfer data, can call following function: example, going generate 500 left hemisphere (\"lh\") thickness maps. maps belong 250 fictional subjects, underwent 2 MRI sessions (\"01\" \"02\") belong two cohorts (\"cohort1\" \"cohort2\"). resolution fake surface maps 163842 vertices (corresponding detailed FreeSurfer template \"fsaverage\"), overall mean 6.5 (mm thickness) standard deviation 0.5. can also use function specify simulated association variable choice. TODO","code":"# Simulate FreeSurfer dataset my_dataset_structure = list(\"cohort1\" = list(\"sessions\" = c(\"01\", \"02\"),                                              \"n_subjects\" = 100),                             \"cohort2\" = list(\"sessions\" = c(\"01\", \"02\"),                                              \"n_subjects\" = 150)                             ) my_random_seed = 1984  simulate_freesurfer_data(path = \"./VeryWiseUser/SimulatedExample\",                          data_structure = my_dataset_structure,                          vw_resolution = 163842,                          measure = \"thickness\",                          hemi = \"lh\",                          fwhmc = \"fwhm10\",                          target = \"fsaverage\",                          vw_mean = 6.5,                          vw_sd = 0.5,                          simulate_association = NULL,                          seed = my_random_seed)"},{"path":"https://seredef.github.io/verywise/articles/02-simulate-data.html","id":"only-generate-the-phenotype-data","dir":"Articles","previous_headings":"","what":"Only generate the phenotype data","title":"Optional: simulating data","text":"hand, already surfaces like phenotype go can use: generate minimum “long format” dataframe variables need, well simulated “sex” “age” sample.","code":"# Simulate phenotype dataset simulate_long_pheno_data(data_structure = my_dataset_structure,                          seed = my_random_seed)"},{"path":"https://seredef.github.io/verywise/articles/02-simulate-data.html","id":"alright-all-in-one-go-now","dir":"Articles","previous_headings":"","what":"Alright, all in one go now","title":"Optional: simulating data","text":"call simulate_long_pheno_data() simulate_freesurfer_data() give everything need play around verywise model fitting.","code":"# Simulate FreeSurfer and phenotype dataset simulate_data(path = \"./VeryWiseUser/SimulatedExample\",                data_structure = my_dataset_structure,               simulate_association =  0.05 * pheno$age,               overwrite = TRUE,               seed = my_random_seed)"},{"path":"https://seredef.github.io/verywise/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Serena Defina. Maintainer, author. Sander Lamballais. Author. Bing Xu. Contributor. Annet Dijkzeul. Contributor. Ryan Muetzel. Contributor, funder.","code":""},{"path":"https://seredef.github.io/verywise/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Defina S, Lamballais S (2025). verywise: Vertex-wise Statistical Analysis Neuroimaging data. R package version 1.2.1, https://github.com/SereDef/verywise.","code":"@Manual{,   title = {verywise: Vertex-wise Statistical Analysis of Neuroimaging data},   author = {Serena Defina and Sander Lamballais},   year = {2025},   note = {R package version 1.2.1},   url = {https://github.com/SereDef/verywise}, }"},{"path":[]},{"path":"https://seredef.github.io/verywise/index.html","id":"vertex-wise-whole-brain-linear-mixed-models","dir":"","previous_headings":"","what":"vertex-wise, whole-brain linear mixed models","title":"Vertex-wise Statistical Analysis of Neuroimaging data","text":"goal verywise offer flexible, user-friendly interface whole-brain analysis neuro-imaging data pre-processed using FreeSurfer. package specifically designed analysis longitudinal (e.g. multi-session) /multi-site neuroimaging data. Currently, verywise allows estimation vertex-wise Linear Mixed Models, extended statistical models future. can handle imputed (phenotype) data several packages (mice, mi, amelia, etc.). Multiple testing correction currently achieved using MCZ simulations FreeSurfer. means need FreeSurfer installed correctly set .","code":""},{"path":"https://seredef.github.io/verywise/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Vertex-wise Statistical Analysis of Neuroimaging data","text":"can install development version verywise GitHub :","code":"# install.packages(\"devtools\") devtools::install_github(\"SereDef/verywise\")"},{"path":"https://seredef.github.io/verywise/index.html","id":"basic-use","dir":"","previous_headings":"","what":"Basic use","title":"Vertex-wise Statistical Analysis of Neuroimaging data","text":"can find info tutorials .","code":"library(verywise) # Run a linear mixed model run_vw_lmm(   formula = vw_thickness ~ sex * age + site + (1 | id), # model formula   subj_dir = \"./VeryWiseUserUser/SimulatedExample\", # Neuro-imaging data location   hemi = \"both\", # (default) which hemispheres to run   pheno = phenotype, # An R object already in memory or path to file  )"},{"path":"https://seredef.github.io/verywise/index.html","id":"visualization","dir":"","previous_headings":"","what":"Visualization","title":"Vertex-wise Statistical Analysis of Neuroimaging data","text":"inspect plot results can use interactive web application, verywiseWIZard. can run locally try .","code":""},{"path":"https://seredef.github.io/verywise/index.html","id":"note","dir":"","previous_headings":"","what":"Note","title":"Vertex-wise Statistical Analysis of Neuroimaging data","text":"spin-(stable) QDECR package.","code":""},{"path":"https://seredef.github.io/verywise/index.html","id":"funders","dir":"","previous_headings":"","what":"Funders","title":"Vertex-wise Statistical Analysis of Neuroimaging data","text":"work supported FLAG-ERA grant Infant2Adult Netherlands Organization Health Research Development (ZonMw, grant number 16080606). feedback contributions welcome!.","code":""},{"path":"https://seredef.github.io/verywise/reference/as.mgh.html","id":null,"dir":"Reference","previous_headings":"","what":"Create an object structured like an MGH object — as.mgh","title":"Create an object structured like an MGH object — as.mgh","text":"Create object structured like MGH object","code":""},{"path":"https://seredef.github.io/verywise/reference/as.mgh.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create an object structured like an MGH object — as.mgh","text":"","code":"as.mgh(   x,   version = 1L,   ndim1 = as.integer(length(x)),   ndim2 = 1L,   ndim3 = 1L,   nframes = 1L,   type = 3L,   dof = 0L )"},{"path":"https://seredef.github.io/verywise/reference/as.mgh.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create an object structured like an MGH object — as.mgh","text":"x vertex-wise values version Version (default = 1) ndim1 Width / 1st dimension (default = length(x)) ndim2 Height / 2nd dimension (default = 1) ndim3 Depth / 3rd dimension (default = 1) nframes Number scalar components (default = 1) type Data type, can UCHAR (0), SHORT (4), INT (1) FLOAT (3) (default = 3) dof Degrees freedom (default = 0)","code":""},{"path":"https://seredef.github.io/verywise/reference/as.mgh.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create an object structured like an MGH object — as.mgh","text":"mgh object data various header elements","code":""},{"path":"https://seredef.github.io/verywise/reference/as.mgh.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Create an object structured like an MGH object — as.mgh","text":"Sander Lamballais, 2018.","code":""},{"path":"https://seredef.github.io/verywise/reference/barnard.rubin.html","id":null,"dir":"Reference","previous_headings":"","what":"Pooled degrees of freedom calculation — barnard.rubin","title":"Pooled degrees of freedom calculation — barnard.rubin","text":"Edited mice::barnard.rubin. function computes residual degrees freedom hypothesis testing, proposed Barnard & Rubin (1999). used vw_pool function.","code":""},{"path":"https://seredef.github.io/verywise/reference/barnard.rubin.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pooled degrees of freedom calculation — barnard.rubin","text":"","code":"barnard.rubin(lambda, m, dfcom = Inf)"},{"path":"https://seredef.github.io/verywise/reference/barnard.rubin.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Pooled degrees of freedom calculation — barnard.rubin","text":"lambda : Proportion total variance due missingness m : Number imputed datasets dfcom : Residual degrees freedom, estimated using stats::df.residual()","code":""},{"path":"https://seredef.github.io/verywise/reference/barnard.rubin.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Pooled degrees of freedom calculation — barnard.rubin","text":"Value residual degrees freedom","code":""},{"path":"https://seredef.github.io/verywise/reference/barnard.rubin.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Pooled degrees of freedom calculation — barnard.rubin","text":"Barnard, J. Rubin, D.B. (1999). Small sample degrees freedom multiple imputation. Biometrika, 86, 948-955.","code":""},{"path":"https://seredef.github.io/verywise/reference/build_supersubject.html","id":null,"dir":"Reference","previous_headings":"","what":"Build ","title":"Build ","text":"Build \"supersubject\" stacking vertex data one large file-backed matrix dimensions n_subjects x n_vertices.","code":""},{"path":"https://seredef.github.io/verywise/reference/build_supersubject.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Build ","text":"","code":"build_supersubject(   subj_dir,   folder_ids,   supsubj_dir,   measure,   hemi,   n_cores,   fwhmc = \"fwhm10\",   fs_template = \"fsaverage\",   backing,   error_cutoff = 20,   save_rds = FALSE,   verbose = TRUE )"},{"path":"https://seredef.github.io/verywise/reference/build_supersubject.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Build ","text":"subj_dir : path FreeSurfer data, expects verywise structure. folder_ids : vector observations include. holds relative path (subj_dir) FreeSurfer data folder (e.g. \"site1/sub-1_ses-01\"). supsubj_dir : output path, logs, backing files matrix (save_rds == TRUE) stored. measure : vertex-wise measure, used identify files. hemi : hemisphere, used identify files. n_cores : number cores use parallel processing. fwhmc : (default = \"fwhm10\") full-width half maximum value, used identify files. fs_template : (default = \"fsaverage\") template register vertex-wise data. following values accepted: fsaverage (default) = 163842 vertices (highest resolution), fsaverage6 = 40962 vertices, fsaverage5 = 10242 vertices, fsaverage4 = 2562 vertices, fsaverage3 = 642 vertices Note , moment, used downsample brain map, faster model tuning. verywise expects input data always registered \"fsaverage\" template final analyses also run using fs_template = \"fsaverage\" avoid (small) imprecisions vertex registration smoothing. backing : (default = supsubj_dir) location save matrix backingfile. error_cutoff : (default = 20) many missing directories brain surface files function stop error. < error_cutoff directories/files found warning thrown missing files registered issues.log file. save_rds : (default = FALSE) save supersubject file metadata re-use sessions. verbose : (default = TRUE)","code":""},{"path":"https://seredef.github.io/verywise/reference/build_supersubject.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Build ","text":"Filebacked Big Matrix vertex data subjects (dimensions: n_subjects x n_vertices)","code":""},{"path":"https://seredef.github.io/verywise/reference/build_supersubject.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Build ","text":"Serena Defina, 2024.","code":""},{"path":"https://seredef.github.io/verywise/reference/check_pheno_obj.html","id":null,"dir":"Reference","previous_headings":"","what":"Check that object exists in the global environment — check_pheno_obj","title":"Check that object exists in the global environment — check_pheno_obj","text":"Check object exists global environment","code":""},{"path":"https://seredef.github.io/verywise/reference/check_pheno_obj.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check that object exists in the global environment — check_pheno_obj","text":"","code":"check_pheno_obj(obj_name)"},{"path":"https://seredef.github.io/verywise/reference/check_pheno_obj.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check that object exists in the global environment — check_pheno_obj","text":"obj_name character string specifying name object","code":""},{"path":"https://seredef.github.io/verywise/reference/check_pheno_obj.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check that object exists in the global environment — check_pheno_obj","text":"object global environment (exists).","code":""},{"path":"https://seredef.github.io/verywise/reference/check_pheno_obj.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Check that object exists in the global environment — check_pheno_obj","text":"function checks specified object exists global environment. returns object found, otherwise raises error message.","code":""},{"path":"https://seredef.github.io/verywise/reference/compute_clusters.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute significant clusters of vertices — compute_clusters","title":"Compute significant clusters of vertices — compute_clusters","text":"function wrapper FreeSurfer command mri_surfcluster. computes clusters significant vertices.","code":""},{"path":"https://seredef.github.io/verywise/reference/compute_clusters.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute significant clusters of vertices — compute_clusters","text":"","code":"compute_clusters(   stack_path,   hemi,   fwhm,   FS_HOME,   cwp_thr = 0.025,   mcz_thr = 30,   csd_sign = \"abs\",   full_surfcluster_output = FALSE,   mask = NULL,   verbose = FALSE )"},{"path":"https://seredef.github.io/verywise/reference/compute_clusters.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute significant clusters of vertices — compute_clusters","text":"stack_path : path term's p values stored results generated. hemi : hemisphere. fwhm : full-width half maximum estimate data smoothness. FS_HOME : FreeSurfer directory, .e. $FREESURFER_HOME cwp_thr : (default = 0.025, hemispheres ran, else 0.05) cluster-wise p-value threshold top corrections. mcz_thr : (default = 0.001) numeric value Monte Carlo simulation threshold. following accepted (equivalent values separate /): 13 / 1.3 / 0.05, 20 / 2.0 / 0.01, . * 23 / 2.3 / 0.005, 30 / 3.0 / 0.001, \\* default 33 / 3.3 / 0.0005, 40 / 4.0 / 0.0001. csd_sign : (default = \"abs\") full_surfcluster_output : (default = FALSE) whether save additional files: .cluster.mgh: map cluster-wise significances files: .voxel.mgh: map corrected voxel-wise significance files: .ocn.annot: output clusters annotation files: .masked.mgh: input non-clusters set 0 mask : apply mask (default = cortical mask + excluding problematic vertices) verbose : (default = FALSE) verbosity.","code":""},{"path":"https://seredef.github.io/verywise/reference/convert_to_mgh.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert statistical result FBMs to FreeSurfer .mgh format — convert_to_mgh","title":"Convert statistical result FBMs to FreeSurfer .mgh format — convert_to_mgh","text":"function takes list FBM objects storing statistical results writes FreeSurfer-compatible .mgh files. supports coefficient, standard error, p-value, residual maps, optional --fly \\(-\\log_{10}\\) transformation p-values.","code":""},{"path":"https://seredef.github.io/verywise/reference/convert_to_mgh.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert statistical result FBMs to FreeSurfer .mgh format — convert_to_mgh","text":"","code":"convert_to_mgh(   vw_results,   result_path,   stacks,   stat_names = c(\"coef\", \"se\", \"p\", \"-log10p\", \"resid\"),   verbose = TRUE )"},{"path":"https://seredef.github.io/verywise/reference/convert_to_mgh.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert statistical result FBMs to FreeSurfer .mgh format — convert_to_mgh","text":"vw_results named list FBM objects containing statistical results. result_path Character string indicating base output path .mgh files written. stacks Vector stack identifiers (e.g. hemisphere stack IDs) included output filenames (non-residual stats). stat_names Character vector statistic names process. Default: c(\"coef\",\"se\",\"p\",\"-log10p\",\"resid\"). special name \"-log10p\" triggers --fly p-value transformation. verbose Logical. Default: TRUE","code":""},{"path":"https://seredef.github.io/verywise/reference/convert_to_mgh.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert statistical result FBMs to FreeSurfer .mgh format — convert_to_mgh","text":"Invisibly returns NULL. Side effects: .mgh files written disk.","code":""},{"path":"https://seredef.github.io/verywise/reference/convert_to_mgh.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Convert statistical result FBMs to FreeSurfer .mgh format — convert_to_mgh","text":"residuals, rows written single .mgh file. stats, data written one file per row (.e. term). computing \\(-\\log_{10}(p)\\) values, transformation applied chunks columns avoid loading full FBM memory.","code":""},{"path":"https://seredef.github.io/verywise/reference/convert_to_mgh.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Convert statistical result FBMs to FreeSurfer .mgh format — convert_to_mgh","text":"","code":"if (FALSE) { # \\dontrun{ library(bigstatsr)  # Dummy vw_results list with small FBMs vw_results <- list(   coef = FBM(5, 10, init = rnorm(50)),   se   = FBM(5, 10, init = runif(50, 0.1, 1)),   p    = FBM(5, 10, init = runif(50, 0, 1)),   resid= FBM(20, 10, init = rnorm(200)) )  convert_to_mgh(   vw_results = vw_results,   result_path = \"my_results/stat\",   stacks = 1:5 ) } # }"},{"path":"https://seredef.github.io/verywise/reference/create_cortex_mask.html","id":null,"dir":"Reference","previous_headings":"","what":"@title Save logical cortex mask from FreeSurfer cortex.label files — create_cortex_mask","title":"@title Save logical cortex mask from FreeSurfer cortex.label files — create_cortex_mask","text":"@title Save logical cortex mask FreeSurfer cortex.label files","code":""},{"path":"https://seredef.github.io/verywise/reference/create_cortex_mask.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"@title Save logical cortex mask from FreeSurfer cortex.label files — create_cortex_mask","text":"","code":"create_cortex_mask(   freesurfer_home = \"\",   fsaverage_template = \"fsaverage\",   hemi = \"lh\",   outp_path = getwd() )"},{"path":"https://seredef.github.io/verywise/reference/create_cortex_mask.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"@title Save logical cortex mask from FreeSurfer cortex.label files — create_cortex_mask","text":"freesurfer_home : path freesurfer home fsaverage_template : one \"fsaverage\" (163842 vertices), \"fsaverage6\" (40962), \"fsaverage5\" (10242), \"fsaverage4\" (2562), \"fsaverage3\" (642) hemi : \"lh\" \"rh\" outp_path : path save logical mask","code":""},{"path":"https://seredef.github.io/verywise/reference/estimate_fwhm.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate full-width half maximum (FWHM) — estimate_fwhm","title":"Estimate full-width half maximum (FWHM) — estimate_fwhm","text":"function wrapper FreeSurfer command mris_fwhm. estimates full-width half maximum (FWHM) brain data based residuals model.","code":""},{"path":"https://seredef.github.io/verywise/reference/estimate_fwhm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate full-width half maximum (FWHM) — estimate_fwhm","text":"","code":"estimate_fwhm(   result_path,   hemi,   mask = NULL,   fs_template = \"fsaverage\",   verbose = FALSE )"},{"path":"https://seredef.github.io/verywise/reference/estimate_fwhm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate full-width half maximum (FWHM) — estimate_fwhm","text":"result_path : path model residuals stored results generated: includes two files: \"hemi.measure.fwhm.dat\" \"hemi.measure.finamMask.mgh\". hemi : hemisphere. mask : apply mask (default = cortical mask + excluding problematic vertices) fs_template : (default = \"fsaverage\") data template. verbose : (default = FALSE) verbosity.","code":""},{"path":"https://seredef.github.io/verywise/reference/estimate_fwhm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate full-width half maximum (FWHM) — estimate_fwhm","text":"integer FWHM value","code":""},{"path":"https://seredef.github.io/verywise/reference/fbm2mgh.html","id":null,"dir":"Reference","previous_headings":"","what":"Save file backed matrix (FBM) to MGH file — fbm2mgh","title":"Save file backed matrix (FBM) to MGH file — fbm2mgh","text":"Save file backed matrix (FBM) MGH file","code":""},{"path":"https://seredef.github.io/verywise/reference/fbm2mgh.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Save file backed matrix (FBM) to MGH file — fbm2mgh","text":"","code":"fbm2mgh(fbm, fnames, mode = \"1row.1file\")"},{"path":"https://seredef.github.io/verywise/reference/fbm2mgh.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Save file backed matrix (FBM) to MGH file — fbm2mgh","text":"fbm file backed matrix fnames file name used save data mode \"1row.1file\" \"allrows.1file\"","code":""},{"path":"https://seredef.github.io/verywise/reference/fbm2mgh.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Save file backed matrix (FBM) to MGH file — fbm2mgh","text":"Serena Defina, 2025. Modified version save_mgh.m (Heath Pardoe, 09/12/2013)","code":""},{"path":"https://seredef.github.io/verywise/reference/fbm_col_has_0.html","id":null,"dir":"Reference","previous_headings":"","what":"Check if all row elements are 0 in FBM — fbm_col_has_0","title":"Check if all row elements are 0 in FBM — fbm_col_has_0","text":"Check row elements FBM 0. used clean super-subject matrix mask_cortex.","code":""},{"path":"https://seredef.github.io/verywise/reference/fbm_col_has_0.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check if all row elements are 0 in FBM — fbm_col_has_0","text":"","code":"fbm_col_has_0(   X,   n_cores = 1,   row.ind = bigstatsr::rows_along(X),   col.ind = bigstatsr::cols_along(X),   row.mask = NULL,   col.mask = NULL,   verbose = TRUE )"},{"path":"https://seredef.github.io/verywise/reference/fbm_col_has_0.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check if all row elements are 0 in FBM — fbm_col_has_0","text":"X : file-backed matrix (FBM) object n_cores : (default = 1) number cores parellalization row.ind : indicator rows col.ind : indicator columns row.mask : (default = NULL) specify subset rows col.mask : (default = NULL) specify subset columns verbose : (default = TRUE)","code":""},{"path":"https://seredef.github.io/verywise/reference/fbm_col_has_0.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check if all row elements are 0 in FBM — fbm_col_has_0","text":"(large) logical vector rows 0.","code":""},{"path":"https://seredef.github.io/verywise/reference/fbm_col_has_0.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Check if all row elements are 0 in FBM — fbm_col_has_0","text":"Serena Defina, 2024.","code":""},{"path":"https://seredef.github.io/verywise/reference/get_terms.html","id":null,"dir":"Reference","previous_headings":"","what":"Unpack lme4 formula — get_terms","title":"Unpack lme4 formula — get_terms","text":"Get terms fixed effect given formula.","code":""},{"path":"https://seredef.github.io/verywise/reference/get_terms.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Unpack lme4 formula — get_terms","text":"","code":"get_terms(formula, dset)"},{"path":"https://seredef.github.io/verywise/reference/get_terms.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Unpack lme4 formula — get_terms","text":"formula : model formula object (specify LME model) dset : data.frame, example first element list output imp2list.","code":""},{"path":"https://seredef.github.io/verywise/reference/get_terms.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Unpack lme4 formula — get_terms","text":"character vector fixed terms.","code":""},{"path":"https://seredef.github.io/verywise/reference/get_terms.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Unpack lme4 formula — get_terms","text":"Serena Defina, 2024.","code":""},{"path":"https://seredef.github.io/verywise/reference/imp2list.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert imputation object to a list of dataframes — imp2list","title":"Convert imputation object to a list of dataframes — imp2list","text":"Converts known imputation objects (e.g., amelia, aregImpute, mi, mids, missForest) list dataframes.","code":""},{"path":"https://seredef.github.io/verywise/reference/imp2list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert imputation object to a list of dataframes — imp2list","text":"","code":"imp2list(obj)"},{"path":"https://seredef.github.io/verywise/reference/imp2list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert imputation object to a list of dataframes — imp2list","text":"obj imputation object contains imputed datasets","code":""},{"path":"https://seredef.github.io/verywise/reference/imp2list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert imputation object to a list of dataframes — imp2list","text":"list imputed datasets","code":""},{"path":"https://seredef.github.io/verywise/reference/imp2list.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Convert imputation object to a list of dataframes — imp2list","text":"function attempts unify imputation object formats supplying datasets. done extracting imputed datasets imputation object assembling list. unknown object supplied, function throw error request supply list data frames instead. generic function: methods can defined directly, see methods(imp2list) list available methods.","code":""},{"path":"https://seredef.github.io/verywise/reference/imp2list.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Convert imputation object to a list of dataframes — imp2list","text":"Sander Lamballais, 2018.","code":""},{"path":"https://seredef.github.io/verywise/reference/list.dirs.till.html","id":null,"dir":"Reference","previous_headings":"","what":"List sub-directories till depth n — list.dirs.till","title":"List sub-directories till depth n — list.dirs.till","text":"Small recursive utility list directories given complex folder structure. used build_supersubject listing sub-directories correct level.","code":""},{"path":"https://seredef.github.io/verywise/reference/list.dirs.till.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"List sub-directories till depth n — list.dirs.till","text":"","code":"list.dirs.till(path, n)"},{"path":"https://seredef.github.io/verywise/reference/list.dirs.till.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"List sub-directories till depth n — list.dirs.till","text":"path : path begin search n : depth recursive process (.e., many levels sub-directories list)","code":""},{"path":"https://seredef.github.io/verywise/reference/list.dirs.till.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"List sub-directories till depth n — list.dirs.till","text":"list directory/sub-directory names.","code":""},{"path":"https://seredef.github.io/verywise/reference/list.dirs.till.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"List sub-directories till depth n — list.dirs.till","text":"Serena Defina, 2024.","code":""},{"path":"https://seredef.github.io/verywise/reference/load.mgh.html","id":null,"dir":"Reference","previous_headings":"","what":"Load an MGH file into memory — load.mgh","title":"Load an MGH file into memory — load.mgh","text":"Load MGH file memory","code":""},{"path":"https://seredef.github.io/verywise/reference/load.mgh.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Load an MGH file into memory — load.mgh","text":"","code":"load.mgh(file_path)"},{"path":"https://seredef.github.io/verywise/reference/load.mgh.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Load an MGH file into memory — load.mgh","text":"file_path : (full) path mgh file.","code":""},{"path":"https://seredef.github.io/verywise/reference/load.mgh.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Load an MGH file into memory — load.mgh","text":"mgh object data various header elements","code":""},{"path":"https://seredef.github.io/verywise/reference/load.mgh.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Load an MGH file into memory — load.mgh","text":"Heath Perdoe, 2013.","code":""},{"path":"https://seredef.github.io/verywise/reference/load_pheno_file.html","id":null,"dir":"Reference","previous_headings":"","what":"Load ","title":"Load ","text":"Takes path file reads memory.","code":""},{"path":"https://seredef.github.io/verywise/reference/load_pheno_file.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Load ","text":"","code":"load_pheno_file(pheno_str, verbose = TRUE)"},{"path":"https://seredef.github.io/verywise/reference/load_pheno_file.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Load ","text":"pheno_str character string specifying file path. verbose (default = TRUE).","code":""},{"path":"https://seredef.github.io/verywise/reference/load_pheno_file.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Load ","text":"data frame containing loaded data","code":""},{"path":"https://seredef.github.io/verywise/reference/load_pheno_file.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Load ","text":"function checks file exists, identifies file extension, loads data accordingly. Supported file types: .csv, .rds, .sav, .txt.","code":""},{"path":"https://seredef.github.io/verywise/reference/locate_roi.html","id":null,"dir":"Reference","previous_headings":"","what":"Locate vertices belonging to specific cortical ROIs — locate_roi","title":"Locate vertices belonging to specific cortical ROIs — locate_roi","text":"function identifies vertices cortical surface mesh correspond one specified regions interest (ROIs), based 36 regions Desikan-Killiany atlas distributed FreeSurfer (aparc.annot). ROIs specified, returns full lookup table ROIs vertex counts, proportions, lobe assignments.","code":""},{"path":"https://seredef.github.io/verywise/reference/locate_roi.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Locate vertices belonging to specific cortical ROIs — locate_roi","text":"","code":"locate_roi(rois = NULL, n_verts = 163842, hemi = c(\"lh\", \"rh\"), verbose = TRUE)"},{"path":"https://seredef.github.io/verywise/reference/locate_roi.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Locate vertices belonging to specific cortical ROIs — locate_roi","text":"rois Optional character vector ROI names locate (e.g., c(\"insula\", \"precentral\")). NULL (default), function returns full ROI lookup table. n_verts Integer. Total number surface vertices consider (default: 163842 \"fsaverage\"). hemi String: \"lh\" \"rh\". Used point hemisphere-specific aparc annotation file. verbose Logical (default: TRUE).","code":""},{"path":"https://seredef.github.io/verywise/reference/locate_roi.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Locate vertices belonging to specific cortical ROIs — locate_roi","text":"rois NULL, returns data.frame : roi_id: ROI numeric ID roi_label: ROI name vw_count: Number vertices ROI vw_prop: Proportion total vertices ROI roi_lobe: Anatomical lobe classification lobe_count: Total number vertices lobe lobe_prop: Proportion vertices lobe rois provided, returns logical vector length n_verts, TRUE indicates vertex belongs one selected ROIs.","code":""},{"path":"https://seredef.github.io/verywise/reference/locate_roi.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Locate vertices belonging to specific cortical ROIs — locate_roi","text":"","code":"# Get the full ROI lookup table roi_table <- locate_roi()  # Get a logical vector of vertices in the insula insula_mask <- locate_roi(rois = \"insula\") #>  * selected 5229 vertices (3.2%)"},{"path":"https://seredef.github.io/verywise/reference/make_chunk_sequence.html","id":null,"dir":"Reference","previous_headings":"","what":"Define chunks of vertices for analyses — make_chunk_sequence","title":"Define chunks of vertices for analyses — make_chunk_sequence","text":"function takes vector values representing dimension vertex-wise data use splits chunks memory-efficient parallel processing.","code":""},{"path":"https://seredef.github.io/verywise/reference/make_chunk_sequence.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Define chunks of vertices for analyses — make_chunk_sequence","text":"","code":"make_chunk_sequence(iv, chunk_size = 1000)"},{"path":"https://seredef.github.io/verywise/reference/make_chunk_sequence.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Define chunks of vertices for analyses — make_chunk_sequence","text":"iv : indices vertex-wise brain data use. chunk_size : (default = 1000) big chunks","code":""},{"path":"https://seredef.github.io/verywise/reference/make_chunk_sequence.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Define chunks of vertices for analyses — make_chunk_sequence","text":"list n_chunks elements. element vector vertex positions.","code":""},{"path":"https://seredef.github.io/verywise/reference/make_chunk_sequence.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Define chunks of vertices for analyses — make_chunk_sequence","text":"Serena Defina, 2024.","code":""},{"path":"https://seredef.github.io/verywise/reference/mask_cortex.html","id":null,"dir":"Reference","previous_headings":"","what":"Clean out vertices that are not on the cortex — mask_cortex","title":"Clean out vertices that are not on the cortex — mask_cortex","text":"Clean super-subject matrix vertices 0 value located cortex, according FreeSurfer *cortical.mask.mgh file distributed inst/extdata. function used build_supersubject.","code":""},{"path":"https://seredef.github.io/verywise/reference/mask_cortex.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Clean out vertices that are not on the cortex — mask_cortex","text":"","code":"mask_cortex(hemi = \"lh\", fs_template = \"fsaverage\")"},{"path":"https://seredef.github.io/verywise/reference/mask_cortex.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Clean out vertices that are not on the cortex — mask_cortex","text":"hemi : (default = \"lh\") hemisphere (\"lh\" \"rh\") fs_template : (default = \"fsaverage\")","code":""},{"path":"https://seredef.github.io/verywise/reference/mask_cortex.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Clean out vertices that are not on the cortex — mask_cortex","text":"(large) logical vector cortical (technical, .e. vertex = 0) mask.","code":""},{"path":"https://seredef.github.io/verywise/reference/move_result_files.html","id":null,"dir":"Reference","previous_headings":"","what":"Move key result files from one directory to another (for sharing and visualization) — move_result_files","title":"Move key result files from one directory to another (for sharing and visualization) — move_result_files","text":"function searches verywise results directory files needed visualization: .e. clusters, coefficient maps, \"stack names\". copies destination directory preserving sub-directory structure source results folder.","code":""},{"path":"https://seredef.github.io/verywise/reference/move_result_files.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Move key result files from one directory to another (for sharing and visualization) — move_result_files","text":"","code":"move_result_files(from_dir, to_dir)"},{"path":"https://seredef.github.io/verywise/reference/move_result_files.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Move key result files from one directory to another (for sharing and visualization) — move_result_files","text":"from_dir Character string indicating path \"source\" results directory (.e. outp_dir analysis call) to_dir Character string indicating path directory matching files copied. Note: required sub-directories created automatically.","code":""},{"path":"https://seredef.github.io/verywise/reference/move_result_files.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Move key result files from one directory to another (for sharing and visualization) — move_result_files","text":"Invisibly returns logical vector indicating whether file successfully copied. Side effects: .mgh files copied to_dir.","code":""},{"path":"https://seredef.github.io/verywise/reference/move_result_files.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Move key result files from one directory to another (for sharing and visualization) — move_result_files","text":"Files matched using regular expression patterns: \"[-z]{1}h.[-z]+.stack[0-9]{1,2}.cache.th30.abs.sig.ocn.mgh\": cluster files \"[-z]{1}h.[-z]+.stack[0-9]{1,2}.coef.mgh\": coefficient (beta) maps \"stack_names.txt\": stack names","code":""},{"path":"https://seredef.github.io/verywise/reference/move_result_files.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Move key result files from one directory to another (for sharing and visualization) — move_result_files","text":"","code":"if (FALSE) { # \\dontrun{ # Move matching files from \"results\" to \"plots\" move_result_files(\"path/to/results\", \"path/to/plots\") } # }"},{"path":"https://seredef.github.io/verywise/reference/pipe.html","id":null,"dir":"Reference","previous_headings":"","what":"Pipe operator — %>%","title":"Pipe operator — %>%","text":"See magrittr::%>% details.","code":""},{"path":"https://seredef.github.io/verywise/reference/pipe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pipe operator — %>%","text":"","code":"lhs %>% rhs"},{"path":"https://seredef.github.io/verywise/reference/pipe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Pipe operator — %>%","text":"lhs value magrittr placeholder. rhs function call using magrittr semantics.","code":""},{"path":"https://seredef.github.io/verywise/reference/pipe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Pipe operator — %>%","text":"result calling rhs(lhs).","code":""},{"path":"https://seredef.github.io/verywise/reference/plot_vw_map.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot vertex-wise coefficient maps on a 3D cortical surface — plot_vw_map","title":"Plot vertex-wise coefficient maps on a 3D cortical surface — plot_vw_map","text":"Visualize vertex-wise statistical coefficient maps (e.g., LMM fixed effects) FreeSurfer fsaverage cortical surface using Python's nilearn plotly backends via {reticulate}. Optionally, outlines specific cortical regions interest (ROIs) using FreeSurfer annotation information (.e. 36 regions Desikan-Killiany atlas).","code":""},{"path":"https://seredef.github.io/verywise/reference/plot_vw_map.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot vertex-wise coefficient maps on a 3D cortical surface — plot_vw_map","text":"","code":"plot_vw_map(   res_dir,   term,   hemi = c(\"lh\", \"rh\"),   measure = \"area\",   surface = c(\"inflated\", \"pial\"),   outline_rois = NULL,   fs_home = Sys.getenv(\"FREESURFER_HOME\"),   show_in_browser = TRUE )"},{"path":"https://seredef.github.io/verywise/reference/plot_vw_map.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot vertex-wise coefficient maps on a 3D cortical surface — plot_vw_map","text":"res_dir Character. Path directory containing Freesurfer-style vertex-wise result files (*.mgh). term Character. Name model term visualize (matches entries stack_names.txt). hemi Character. Hemisphere plot (\"lh\" \"rh\"). measure Character. Surface measure, e.g. 'area', 'thickness', 'volume'. Defaults 'area'. surface Character. Surface mesh plot (\"inflated\" \"pial\"). Deaults \"inflated\". outline_rois Optional character vector. ROI names outline surface plot. can use call verywise::locate_roi() see names available ROIs. fs_home Character. Path Freesurfer installation ($FREESURFER_HOME). show_in_browser Logical (default = TRUE). Open Figure browser. can invoked manually well using $show().","code":""},{"path":"https://seredef.github.io/verywise/reference/plot_vw_map.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot vertex-wise coefficient maps on a 3D cortical surface — plot_vw_map","text":"plotly.graph_objects.Figure (Python object) can displayed modified via reticulate.","code":""},{"path":"https://seredef.github.io/verywise/reference/plot_vw_map.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plot vertex-wise coefficient maps on a 3D cortical surface — plot_vw_map","text":"function: Locates appropriate MGH files given model term hemisphere. Loads nibabel via {reticulate}. Displays coefficient map interactively fsaverage inflated surface using nilearn’s plot_surf_stat_map() (Plotly engine). Optionally outlines regions Freesurfer annotation (via verywise). Python dependencies (nibabel, nilearn, matplotlib, plotly, numpy) must installed active {reticulate} environment.","code":""},{"path":"https://seredef.github.io/verywise/reference/plot_vw_map.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot vertex-wise coefficient maps on a 3D cortical surface — plot_vw_map","text":"","code":"if (FALSE) { # rlang::is_installed(\"reticulate\") && dir.exists(\"~/results/fs_results\") # Example usage (requires FreeSurfer fsaverage and precomputed MGH maps) fs_home <- Sys.getenv(\"FREESURFER_HOME\") surf_fig <- plot_vw_map(   res_dir = \"~/results/fs_results\",   term = \"age\",   hemi = \"lh\",   measure = \"area\",   outline_rois = c(\"entorhinal\", \"precuneus\"),   fs_home = fs_home) }"},{"path":"https://seredef.github.io/verywise/reference/pretty_message.html","id":null,"dir":"Reference","previous_headings":"","what":"Print pretty messages to console — pretty_message","title":"Print pretty messages to console — pretty_message","text":"Adds fillers messages","code":""},{"path":"https://seredef.github.io/verywise/reference/pretty_message.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print pretty messages to console — pretty_message","text":"","code":"pretty_message(content, fill = \"=\", tot_nchar = 60, center = TRUE)"},{"path":"https://seredef.github.io/verywise/reference/pretty_message.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print pretty messages to console — pretty_message","text":"content : message print fill : (default \"=\") tot_nchar : (default: 60) center : (default: TRUE) center content.","code":""},{"path":"https://seredef.github.io/verywise/reference/pretty_message.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print pretty messages to console — pretty_message","text":"prettyfyed console message.","code":""},{"path":"https://seredef.github.io/verywise/reference/pretty_message.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Print pretty messages to console — pretty_message","text":"Serena Defina, 2025.","code":""},{"path":"https://seredef.github.io/verywise/reference/run_vw_lmm.html","id":null,"dir":"Reference","previous_headings":"","what":"Run vertex-wise linear mixed model using lme4::lmer() — run_vw_lmm","title":"Run vertex-wise linear mixed model using lme4::lmer() — run_vw_lmm","text":"main function conducting vertex-wise linear mixed model analyses brain surface metrics. first check use inputs, prepare phenotype data(list) run linear mixed model vertex specified hemisphere using single_lmm function. function supports analysis single multiple imputed datasets. also automatically handles cortical masking, provides cluster-wise correction multiple testing using FreeSurfer's Monte Carlo simulation approach.","code":""},{"path":"https://seredef.github.io/verywise/reference/run_vw_lmm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run vertex-wise linear mixed model using lme4::lmer() — run_vw_lmm","text":"","code":"run_vw_lmm(   formula,   pheno,   subj_dir,   outp_dir = NULL,   hemi = c(\"lh\", \"rh\"),   fs_template = \"fsaverage\",   apply_cortical_mask = TRUE,   folder_id = \"folder_id\",   tolerate_surf_not_found = 20,   use_model_template = TRUE,   weights = NULL,   lmm_control = lme4::lmerControl(),   seed = 3108,   n_cores = 1,   chunk_size = 1000,   FS_HOME = Sys.getenv(\"FREESURFER_HOME\"),   fwhm = 10,   mcz_thr = 30,   cwp_thr = 0.025,   save_optional_cluster_info = FALSE,   save_ss = FALSE,   save_residuals = FALSE,   verbose = TRUE )"},{"path":"https://seredef.github.io/verywise/reference/run_vw_lmm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run vertex-wise linear mixed model using lme4::lmer() — run_vw_lmm","text":"formula model formula object. specify linear mixed model lme4 syntax. outcome variable one supported brain surface metrics (see Details). Example: vw_thickness ~ age * sex + site + (1|participant_id). pheno Either data.frame/tibble containing \"phenotype\" data (.e., already loaded global environment), string specifying file path phenotype data. Supported file formats: .rds, .csv, .txt, .sav (SPSS). data long format contain variables specified formula plus folder_id column. subj_dir Character string specifying path FreeSurfer data directory. Must follow verywise directory structure (see package vignette details). outp_dir Character string specifying output directory results. NULL (default), creates \"verywise_results\" sub-directory current working directory (recommended). hemi Character string specifying hemisphere(s) analyze. Options: \"\" (default), \"lh\" (left ), \"rh\" (right ). fs_template Character string specifying FreeSurfer template vertex registration. Options: \"fsaverage\" (default) = 163842 vertices (highest resolution), \"fsaverage6\" = 40962 vertices, \"fsaverage5\" = 10242 vertices, \"fsaverage4\" = 2562 vertices, \"fsaverage3\" = 642 vertices Note lower resolutions used downsample brain map, faster model tuning. final analyses also run using fs_template = \"fsaverage\" avoid (small) imprecisions vertex registration smoothing. apply_cortical_mask Logical indicating whether exclude non-cortical vertices analysis. Default: TRUE (recommended). folder_id Character string specifying column name pheno contains subject directory names input neuroimaging data (e.g. \"sub-001_ses-baseline\" \"site1/sub-010_ses-F1\"). expected nested inside subj_dir. Default: \"folder_id\". tolerate_surf_not_found Integer indicating many brain surface files listed folder_id can missing subj_dir. number missing corrupted files  > tolerate_surf_not_found  execution stop. Default: 20L. use_model_template Logical indicating whether pre-compile model template faster estimation. Default: TRUE (recommended). weights Optional string numeric vector weights linear mixed model. can use argument specify inverse-probability weights. string, function look column name phenotype data. Note normalized standardized way. Default: NULL (weights). lmm_control Optional list (correct class, resulting lmerControl() containing control parameters passed lme4::lmer() (e.g. optimizer choice, convergence criteria, see *lmerControl documentation details. Default: (uses default settings). seed Integer specifying random seed reproducibility Default: 3108. n_cores Integer specifying number CPU cores parallel processing. Default: 1. chunk_size Integer specifying number vertices processed per chunk parallel operations. Larger values use memory may faster. Default: 1000. FS_HOME Character string specifying FreeSurfer home directory. Defaults FREESURFER_HOME environment variable. fwhm Numeric value specifying full-width half-maximum smoothing kernel. Default: 10. mcz_thr Numeric value Monte Carlo simulation threshold. following accepted (equivalent values separate /): 13 / 1.3 / 0.05, 20 / 2.0 / 0.01, 23 / 2.3 / 0.005, 30 / 3.0 / 0.001, \\* default 33 / 3.3 / 0.0005, 40 / 4.0 / 0.0001. cwp_thr Numeric value cluster-wise p-value threshold (top corrections). Set 0.025 hemispheres analyzed, 0.05 single hemisphere. Default: 0.025. save_optional_cluster_info Logical indicating whether save additional output form mri_surfcluster call. See compute_clusters details. Default: FALSE. save_ss Logical indicating whether save super-subject matrix (\"ss\") .rds file can re-used future analyses. can also character string specifying directory ss saved. TRUE, ss matrix saved <outp_dir>/ss default. Default: FALSE. save_residuals Logical indicating whether save residuals.mgh file. Default: FALSE. verbose Logical indicating whether display progress messages. Default: TRUE.","code":""},{"path":"https://seredef.github.io/verywise/reference/run_vw_lmm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run vertex-wise linear mixed model using lme4::lmer() — run_vw_lmm","text":"list file-backed matrices (bigstatsr::FBM objects) containing pooled coefficients, SEs, t- p- values residuals. Results also automatically saved disk .mgh format.","code":""},{"path":"https://seredef.github.io/verywise/reference/run_vw_lmm.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Run vertex-wise linear mixed model using lme4::lmer() — run_vw_lmm","text":"Supported Brain Surface Metrics: outcome specified formula brain surface metric among: vw_thickness - Cortical thickness vw_area - Cortical surface area (white  surface) vw_area.pial - Cortical surface area (pial surface) vw_curv - Mean curvature vw_jacobian_white - Jacobian determinant (white surface) vw_pial - Pial surface coordinates vw_pial_lgi - Local gyrification index (pial surface) vw_sulc - Sulcal depth vw_volume - Gray matter volume vw_w_g.pct - White/gray matter intensity ratio vw_white.H - Mean curvature (white surface) vw_white.K - Gaussian curvature (white surface) Statistical Approach: function uses lme4::lmer() mixed-effects modeling, enabling analysis longitudinal hierarchical data. P-values computed using t--z approximation, cluster-wise correction applied using FreeSurfer's Monte Carlo simulation approach. Multiple Imputation: function automatically detects handles multiple imputed datasets (created mice similar packages), pooling results according Rubin's rules. Parallel processing: verywise package employs carefully designed parallelization strategy maximize computational efficiency avoiding performance penalties associated nested parallelization. Left right cortical hemispheres processed sequentially default. Parallel processing two hemispheres (/different metrics, models) handled user (e.g., using SLURM job arrays similar, see vignette parallelisation ...COMING ). Within hemisphere, vertices divided chunks size chunk_size processed parallel across n_cores workers (n_cores > 1). multiple imputed datasets present, processed sequentially within vertex. Note , systems, implicit parallelism low-level matrix algebra libraries (BLAS/LAPACK) can interfere explicit parallelization. feel like processing taking long, recommend disabling implicit threading libraries starting R. example: Also note using large number cores (e.g. >120) may sometimes cause worker initialization issues (e.g. R parallel processes limits) Output Files: Results saved FreeSurfer-compatible .mgh format visualization verywiseWIZard, FreeView neuroimaging software.","code":"export OPENBLAS_NUM_THREADS=1 export OMP_NUM_THREADS=1 export MKL_NUM_THREADS=1 export VECLIB_MAXIMUM_THREADS=1 export NUMEXPR_NUM_THREADS=1"},{"path":"https://seredef.github.io/verywise/reference/run_vw_lmm.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Run vertex-wise linear mixed model using lme4::lmer() — run_vw_lmm","text":"Ensure FreeSurfer properly installed FREESURFER_HOME environment variable set. Large datasets may require substantial memory. Consider adjusting chunk_size n_cores based system specifications. reproducibility, always specify seed.","code":""},{"path":[]},{"path":"https://seredef.github.io/verywise/reference/run_vw_lmm.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Run vertex-wise linear mixed model using lme4::lmer() — run_vw_lmm","text":"Serena Defina, 2024.","code":""},{"path":"https://seredef.github.io/verywise/reference/run_vw_meta.html","id":null,"dir":"Reference","previous_headings":"","what":"Vertex-wise Random-Effects Meta-Analysis Across Studies — run_vw_meta","title":"Vertex-wise Random-Effects Meta-Analysis Across Studies — run_vw_meta","text":"function runs vertex-wise random-effects meta-analysis across multiple studies (sites cohorts). expects individual study results outputted verywise::run_vw_lmm QDECR.","code":""},{"path":"https://seredef.github.io/verywise/reference/run_vw_meta.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Vertex-wise Random-Effects Meta-Analysis Across Studies — run_vw_meta","text":"","code":"run_vw_meta(   stack,   hemi,   result_dirs,   study_names,   fs_template = \"fsaverage\",   n_cores = 1,   verbose = TRUE )"},{"path":"https://seredef.github.io/verywise/reference/run_vw_meta.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Vertex-wise Random-Effects Meta-Analysis Across Studies — run_vw_meta","text":"stack : Character numeric identifier fixed term meta-analyise. hemi : Character string, hemisphere analyze (\"lh\" \"rh\"). result_dirs : Character vector directories containing results files study. study_names : Character vector study names (must match length result_dirs). fs_template : Character string specifying FreeSurfer template surface. following values accepted: fsaverage (default) = 163842 vertices (highest resolution), fsaverage6 = 40962 vertices, fsaverage5 = 10242 vertices, fsaverage4 = 2562 vertices, fsaverage3 = 642 vertices n_cores : Integer, number CPU cores use parallel processing (default: 1). verbose : Logical, verbose execution (default: TRUE)","code":""},{"path":"https://seredef.github.io/verywise/reference/run_vw_meta.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Vertex-wise Random-Effects Meta-Analysis Across Studies — run_vw_meta","text":"named list three FBM objects: coef Meta-analytic effect size estimates vertex. se Meta-analytic standard errors vertex. p Meta-analytic p-values vertex. Additionally, exported MGH files working directory.","code":""},{"path":"https://seredef.github.io/verywise/reference/run_vw_meta.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Vertex-wise Random-Effects Meta-Analysis Across Studies — run_vw_meta","text":"vertex, function loads effect size standard error study, computes variance, runs random-effects meta-analysis using rma. Results saved Filebacked Big Matrices (FBM) MGH files downstream neuroimaging analysis.","code":""},{"path":[]},{"path":"https://seredef.github.io/verywise/reference/run_vw_meta.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Vertex-wise Random-Effects Meta-Analysis Across Studies — run_vw_meta","text":"","code":"if (FALSE) { # \\dontrun{ run_vw_meta(   stack = 1,   hemi = \"lh\",   result_dirs = c(\"study1/results\", \"study2/results\"),   study_names = c(\"Study1\", \"Study2\"),   fs_template = \"fsaverage\",   n_cores = 4 ) } # }"},{"path":"https://seredef.github.io/verywise/reference/save.mgh.html","id":null,"dir":"Reference","previous_headings":"","what":"Save an MGH file from memory — save.mgh","title":"Save an MGH file from memory — save.mgh","text":"R translation save_mgh.m (Heath Pardoe, 09/12/2013)","code":""},{"path":"https://seredef.github.io/verywise/reference/save.mgh.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Save an MGH file from memory — save.mgh","text":"","code":"save.mgh(vol, file_name)"},{"path":"https://seredef.github.io/verywise/reference/save.mgh.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Save an MGH file from memory — save.mgh","text":"vol MGH object (load.mgh) file_name File name used save data","code":""},{"path":"https://seredef.github.io/verywise/reference/save.mgh.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Save an MGH file from memory — save.mgh","text":"Sander Lamballais, 2018.","code":""},{"path":"https://seredef.github.io/verywise/reference/simulate_dataset.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate a longitudinal brain surface dataset with associated phenotype data — simulate_dataset","title":"Simulate a longitudinal brain surface dataset with associated phenotype data — simulate_dataset","text":"Generates synthetic longitudinal dataset multiple sites/cohorts, multiple timepoints/sessions per subject. function produces: Brain surface data FreeSurfer .mgh format, organised verywise folder structure (see vignettes details). matching pheno data frame mock participant sex age, saved \"phenotype.csv\" path directory. useful testing pipelines demonstrations realistic FreeSurfer-style data phenotypic information required.","code":""},{"path":"https://seredef.github.io/verywise/reference/simulate_dataset.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate a longitudinal brain surface dataset with associated phenotype data — simulate_dataset","text":"","code":"simulate_dataset(   path,   data_structure = list(cohort1 = list(sessions = c(\"01\", \"02\", \"03\"), n_subjects = 10),     cohort2 = list(sessions = c(\"01\", \"02\"), n_subjects = 20)),   fs_template = \"fsaverage\",   roi_subset = c(\"temporalpole\", \"frontalpole\", \"entorhinal\"),   simulate_association = NULL,   location_association = NULL,   overwrite = TRUE,   seed = 3108,   verbose = TRUE,   ... )"},{"path":"https://seredef.github.io/verywise/reference/simulate_dataset.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate a longitudinal brain surface dataset with associated phenotype data — simulate_dataset","text":"path Character string. Directory dataset created. created exist. data_structure Named list defining cohorts/sites. element list : \"sessions\" Character vector session labels. \"n_subjects\" Integer number subjects. fs_template Character (default = \"fsaverage\"). FreeSurfer template vertex registration. used determine size synthetic brain surface data. Options: \"fsaverage\" = 163842 vertices (highest resolution) \"fsaverage6\" = 40962 vertices \"fsaverage5\" = 10242 vertices \"fsaverage4\" = 2562 vertices \"fsaverage3\" = 642 vertices roi_subset Character vector (default = c('temporalpole', 'frontalpole', 'entorhinal')). Vertex-wise data simulated default within smaller subset (~1.5%) total surface. rest vertex values set 0, analysed, saving time estimation. region locations extracted annotation files distributed FreeSurfer saved internally R/sysdata.rda. simulate_association Optional. numeric, must length equal number generated files; character, must format \"<beta> * <variable_name>\". Associations injected one small region (entorhinal cortex). location_association Optional string character vector. specified, association present within ROIs. rest vertex values set relationship predictors. region locations extracted annotation files distributed FreeSurfer saved internally R/sysdata.rda. overwrite Logical (default = TRUE). Whether overwrite existing phenotype file. seed Integer (default = 3108). Random seed. verbose Logical (default = TRUE). TRUE, print progress messages. ... Additional arguments passed simulate_freesurfer_data.","code":""},{"path":"https://seredef.github.io/verywise/reference/simulate_dataset.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate a longitudinal brain surface dataset with associated phenotype data — simulate_dataset","text":"Invisibly returns NULL. Data phenotype files written path.","code":""},{"path":[]},{"path":"https://seredef.github.io/verywise/reference/simulate_dataset.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Simulate a longitudinal brain surface dataset with associated phenotype data — simulate_dataset","text":"Serena Defina, 2024.","code":""},{"path":"https://seredef.github.io/verywise/reference/simulate_freesurfer_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate longitudinal FreeSurfer vertex-wise data — simulate_freesurfer_data","title":"Simulate longitudinal FreeSurfer vertex-wise data — simulate_freesurfer_data","text":"Simulates FreeSurfer-formatted brain surface data multiple cohorts/sites multiple timepoints/sessions. output folder structure emulates produced FreeSurfer recon-command, directories named: sub-<ID>_ses-<SESSION>. vertex-wise data stored .mgh files, optional simulation association phenotype variable.","code":""},{"path":"https://seredef.github.io/verywise/reference/simulate_freesurfer_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate longitudinal FreeSurfer vertex-wise data — simulate_freesurfer_data","text":"","code":"simulate_freesurfer_data(   path,   data_structure = list(cohort1 = list(sessions = c(\"01\", \"02\"), n_subjects = 100),     cohort2 = list(sessions = c(\"01\", \"02\"), n_subjects = 150)),   fs_template = \"fsaverage\",   measure = \"thickness\",   hemi = \"lh\",   fwhmc = \"fwhm10\",   vw_mean = 6.5,   vw_sd = 1.5,   subj_sd = 0.2,   site_sd = 0.1,   roi_subset = c(\"temporalpole\", \"frontalpole\", \"entorhinal\"),   simulate_association = NULL,   location_association = NULL,   seed = 3108,   verbose = TRUE )"},{"path":"https://seredef.github.io/verywise/reference/simulate_freesurfer_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate longitudinal FreeSurfer vertex-wise data — simulate_freesurfer_data","text":"path Character string. Directory dataset created. created exist. data_structure Named list defining cohorts/sites. element list : \"sessions\" Character vector session labels. \"n_subjects\" Integer number subjects. fs_template Character (default = \"fsaverage\"). FreeSurfer template vertex registration. used determine size synthetic brain surface data. Options: \"fsaverage\" = 163842 vertices (highest resolution) \"fsaverage6\" = 40962 vertices \"fsaverage5\" = 10242 vertices \"fsaverage4\" = 2562 vertices \"fsaverage3\" = 642 vertices measure Character (default = \"thickness\"). Surface measure simulate. used file names. hemi Character (default = \"lh\"). Hemisphere code: \"lh\" (left) \"rh\" (right). used file names. fwhmc Character (default = \"fwhm10\"). Full-width half maximum smoothing parameter. used file names. vw_mean Numeric (default = 6.5). Mean simulated vertex-wise values. vw_sd Numeric (default = 0.5). Standard deviation simulated vertex-wise values. subj_sd Numeric (default = 0.2). Standard deviation random intercept subject (relevant multi-session datasets). site_sd Numeric (default = 0.1). Standard deviation random intercept site (relevant multi-site datasets). roi_subset Character vector (default = c('temporalpole', 'frontalpole', 'entorhinal')). Vertex-wise data simulated default within smaller subset (~1.5%) total surface. rest vertex values set 0, analysed, saving time estimation. region locations extracted annotation files distributed FreeSurfer saved internally R/sysdata.rda. simulate_association Optional. numeric, must length equal number generated files; character, must format \"<beta> * <variable_name>\". Associations injected one small region (entorhinal cortex). location_association Optional string character vector. specified, association present within ROIs. rest vertex values set relationship predictors. region locations extracted annotation files distributed FreeSurfer saved internally R/sysdata.rda. seed Integer (default = 3108). Random seed. verbose Logical (default = TRUE). TRUE, print progress messages.","code":""},{"path":"https://seredef.github.io/verywise/reference/simulate_freesurfer_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate longitudinal FreeSurfer vertex-wise data — simulate_freesurfer_data","text":"Invisibly returns NULL. Vertex-wise data written path FreeSurfer-compatible format.","code":""},{"path":[]},{"path":"https://seredef.github.io/verywise/reference/simulate_freesurfer_data.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Simulate longitudinal FreeSurfer vertex-wise data — simulate_freesurfer_data","text":"Serena Defina, 2024.","code":""},{"path":"https://seredef.github.io/verywise/reference/simulate_long_pheno_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate (longitudinal) phenotype data — simulate_long_pheno_data","title":"Simulate (longitudinal) phenotype data — simulate_long_pheno_data","text":"Generates synthetic phenotype data long format multiple cohorts/sites multiple timepoints/sessions per subject. record contains: Subject ID Session/timepoint Sex Age Wisdom folder_id field matching FreeSurfer directory structure","code":""},{"path":"https://seredef.github.io/verywise/reference/simulate_long_pheno_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate (longitudinal) phenotype data — simulate_long_pheno_data","text":"","code":"simulate_long_pheno_data(   data_structure = list(cohort1 = list(sessions = c(\"01\", \"02\"), n_subjects = 100),     cohort2 = list(sessions = c(\"01\", \"02\"), n_subjects = 150)),   seed = 3108,   verbose = TRUE )"},{"path":"https://seredef.github.io/verywise/reference/simulate_long_pheno_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate (longitudinal) phenotype data — simulate_long_pheno_data","text":"data_structure Named list defining cohorts/sites. element list : \"sessions\" Character vector session labels. \"n_subjects\" Integer number subjects. seed Integer (default = 3108). Random seed. verbose Logical (default = TRUE). TRUE, print progress messages.","code":""},{"path":"https://seredef.github.io/verywise/reference/simulate_long_pheno_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate (longitudinal) phenotype data — simulate_long_pheno_data","text":"data.frame long format columns: site, id, time, sex, age, wisdom, folder_id.","code":""},{"path":[]},{"path":"https://seredef.github.io/verywise/reference/simulate_long_pheno_data.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Simulate (longitudinal) phenotype data — simulate_long_pheno_data","text":"Serena Defina, 2024.","code":""},{"path":"https://seredef.github.io/verywise/reference/single_lmm.html","id":null,"dir":"Reference","previous_headings":"","what":"Run a single linear mixed model and extract statistics — single_lmm","title":"Run a single linear mixed model and extract statistics — single_lmm","text":"Fits linear mixed model single vertex outcome using lme4::lmer() extracts fixed effects statistics. function called repeatedly across cortical vertices vertex-wise analysis.","code":""},{"path":"https://seredef.github.io/verywise/reference/single_lmm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run a single linear mixed model and extract statistics — single_lmm","text":"","code":"single_lmm(   imp,   y,   formula,   model_template = NULL,   weights = NULL,   lmm_control = lme4::lmerControl() )"},{"path":"https://seredef.github.io/verywise/reference/single_lmm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run a single linear mixed model and extract statistics — single_lmm","text":"imp data.frame containing phenotype dataset (verywise format). y numeric vector outcome values representing single vertex super-subject matrix. formula R formula object describing linear mixed model using lme4 notation. model_template Optional pre-compiled model object faster estimation. provided, single_lmm use \"update\"-based workflow instead refitting model scratch. minimizes repeated parsing model construction overhead, significantly reducing computation time large-scale vertex-wise analyses. Default: NULL. weights Optional string numeric vector weights linear mixed model. can use argument specify inverse-probability weights. string, function look column name phenotype data. Note normalized standardized way. Default: NULL (weights). lmm_control Optional list (correct class, resulting lmerControl() containing control parameters passed lme4::lmer() (e.g. optimizer choice, convergence criteria, see *lmerControl documentation details. Default: (uses default settings).","code":""},{"path":"https://seredef.github.io/verywise/reference/single_lmm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run a single linear mixed model and extract statistics — single_lmm","text":"list two elements: stats - data.frame columns: term - Fixed effect term names qhat - Parameter estimates se - Standard errors resid - numeric vector model residuals warning - Warning message(s) ","code":""},{"path":"https://seredef.github.io/verywise/reference/single_lmm.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Run a single linear mixed model and extract statistics — single_lmm","text":"Additional parameters currently passed lme4::lmer call using lmm_control argument.","code":""},{"path":[]},{"path":"https://seredef.github.io/verywise/reference/subset_supersubject.html","id":null,"dir":"Reference","previous_headings":"","what":"Subset an existing supersubject matrix by matching folder IDs — subset_supersubject","title":"Subset an existing supersubject matrix by matching folder IDs — subset_supersubject","text":"function subsets FBM supersubject matrix created using build_supersubject(), retaining rows correspond set folder (row) IDs. reads row names associated .csv file, checks missing IDs, writes logs found. new subsetted matrix can saved future use.","code":""},{"path":"https://seredef.github.io/verywise/reference/subset_supersubject.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Subset an existing supersubject matrix by matching folder IDs — subset_supersubject","text":"","code":"subset_supersubject(   supsubj_dir,   supsubj_file,   folder_ids,   error_cutoff = 20,   new_supsubj_dir,   n_cores = 1,   save_rds = FALSE,   verbose = TRUE )"},{"path":"https://seredef.github.io/verywise/reference/subset_supersubject.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Subset an existing supersubject matrix by matching folder IDs — subset_supersubject","text":"supsubj_dir Character string indicating path directory containing supersubject files (.e supersubject matrix .rds file, associated .bk .rownames.csv files). supsubj_file Character string indicating name supersubject .rds file. Must follow naming pattern \"<hemi>.<measure>.<fs_template>.supersubject.rds\". folder_ids Character vector folder IDs retain new ss matrix. also column phenotype dataset. error_cutoff Integer indicating maximum number missing IDs allowed function throws error. number missing IDs  <= error_cutoff , warning issued instead. Default: 20. new_supsubj_dir Character string indicating path directory new supersubject files stored (either temporarily permanently  save_rds == TRUE . Created exist. n_cores Integer indicating number cores use parallel processing. save_rds Logical. TRUE, new ss also saved .rds file inside new_supsubj_dir. verbose Logical. Default: TRUE.","code":""},{"path":"https://seredef.github.io/verywise/reference/subset_supersubject.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Subset an existing supersubject matrix by matching folder IDs — subset_supersubject","text":"FBM object containing subsetted supersubject matrix.","code":""},{"path":"https://seredef.github.io/verywise/reference/subset_supersubject.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Subset an existing supersubject matrix by matching folder IDs — subset_supersubject","text":"function performs following steps: Reads row names supersubject's .csv file. Checks whether folder_ids exist supersubject. Logs missing IDs issues.log new_supsubj_dir. number missing IDs exceeds error_cutoff, stops error. Creates new FBM matching rows, writing blockwise avoid excessive RAM usage. Writes filtered row names ss.rownames.csv new_supsubj_dir.","code":""},{"path":[]},{"path":"https://seredef.github.io/verywise/reference/vw_message.html","id":null,"dir":"Reference","previous_headings":"","what":"Print message to console if verbose = TRUE — vw_message","title":"Print message to console if verbose = TRUE — vw_message","text":"Print message console verbose = TRUE","code":""},{"path":"https://seredef.github.io/verywise/reference/vw_message.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print message to console if verbose = TRUE — vw_message","text":"","code":"vw_message(..., verbose = TRUE)"},{"path":"https://seredef.github.io/verywise/reference/vw_message.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print message to console if verbose = TRUE — vw_message","text":"... : content print verbose (default = TRUE)","code":""},{"path":"https://seredef.github.io/verywise/reference/vw_pool.html","id":null,"dir":"Reference","previous_headings":"","what":"Pool lme4::lmer model output across imputed datasets — vw_pool","title":"Pool lme4::lmer model output across imputed datasets — vw_pool","text":"function combines estimates, standard errors p-values across imputed datasets, single model (.g., one vertex). function largely taken mice::pool() mice::summary.mipo() code. averages estimates complete data model, computes relevant statistics, following Rubin's rules (Rubin, 1987, p. 76). P-values estimation Default: P-values estimated using t--z approach. known anti-conservative small sample sizes provides computationally efficient solution. Type error control addressed rigorously cluster-forming stage. Wald Chi-square test Satterthwaite Approximation residuals model currently simply averaged across imputed datasets, lack better idea combine .","code":""},{"path":"https://seredef.github.io/verywise/reference/vw_pool.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pool lme4::lmer model output across imputed datasets — vw_pool","text":"","code":"vw_pool(out_stats, m, pvalue_method = \"t-as-z\", min_pvalue = 2^-149)"},{"path":"https://seredef.github.io/verywise/reference/vw_pool.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Pool lme4::lmer model output across imputed datasets — vw_pool","text":"out_stats Output single_lmm, .e.: list containing: \"stats\": dataframe estimates SEs fixed effect term) \"resid\": vector residuals given model. \"warning\": character vector warning messages () Note model failed dataset out_stats form list(\"error\"=\"Error message\") m Integer indicating number (imputed) dataset pvalue_method String indicating approximation methods used compute p-values. Options: \"t--z\", \"wald-chi2\", \"satterthwaite\" (see Details). Default: \"t--z\". min_pvalue Float, used avoid pvalues == 0L log10 Inf. Set 0L trimming applied. Default: 2^-149 ( == 1.401298e-45) smallest positive subnormal float.","code":""},{"path":"https://seredef.github.io/verywise/reference/vw_pool.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Pool lme4::lmer model output across imputed datasets — vw_pool","text":"list containing pooled coefficients, SEs, t- p- values.","code":""},{"path":"https://seredef.github.io/verywise/reference/vw_pool.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Pool lme4::lmer model output across imputed datasets — vw_pool","text":"Used inside run_vw_lmm.","code":""},{"path":"https://seredef.github.io/verywise/reference/vw_pool.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Pool lme4::lmer model output across imputed datasets — vw_pool","text":"Rubin, D.B. (1987). Multiple Imputation Nonresponse Surveys. New York: John Wiley Sons.","code":""},{"path":"https://seredef.github.io/verywise/reference/vw_pool.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Pool lme4::lmer model output across imputed datasets — vw_pool","text":"Serena Defina, 2024.","code":""}]
