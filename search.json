[{"path":"https://seredef.github.io/verywise/articles/00-installation-sys-requirements.html","id":"installation","dir":"Articles","previous_headings":"","what":"Installation","title":"Getting ready, step 1: Installation and system requirements","text":"can install development version verywise GitHub. : may need install devtools package first (already installed). also download R packages needed, give little minute. Finally, can attach package make easier use, like :","code":"# Install devtools (if not there yet) if (!requireNamespace(\"devtools\"))   install.packages('devtools')  # Install verywise devtools::install_github(\"SereDef/verywise\") library(verywise) #> Welcome, verywise user! #> This is version: 1.0.0 #> For questions, issues, and bug reports, please see https://github.com/SereDef/verywise"},{"path":"https://seredef.github.io/verywise/articles/00-installation-sys-requirements.html","id":"system-and-software-requirements","dir":"Articles","previous_headings":"","what":"System and software requirements","title":"Getting ready, step 1: Installation and system requirements","text":"order verywise run smoothly, need: R (version >= 4.1) installed (Dah!). Unix system: verywise works Mac Linux distributions, Windows. currently rely functions FreeSurfer suite require Unix/Mac. FreeSurfer installed.","code":""},{"path":"https://seredef.github.io/verywise/articles/00-installation-sys-requirements.html","id":"installing-and-setting-up-freesurfer","dir":"Articles","previous_headings":"System and software requirements","what":"Installing and setting up FreeSurfer","title":"Getting ready, step 1: Installation and system requirements","text":"TODO","code":""},{"path":"https://seredef.github.io/verywise/articles/01-format-data.html","id":"a-verywise-input-directory-structure","dir":"Articles","previous_headings":"","what":"A verywise input directory structure","title":"Getting ready, step 2: formatting input data","text":"example typical verywise input directory:  also see use data simulation functions. phenotype file need inside folder neuroimaging data, placed keep things tidy. one neuroimaging site (“cohort” dataset, however want call ), site ’s folder. Inside site folder one sub-folder individual measurement (“session”). sub-folders follow BIDS convention, example: sub-47_ses-03 3rd measurement subject #47. done automatically FreeSurfer (see next session)","code":""},{"path":"https://seredef.github.io/verywise/articles/01-format-data.html","id":"preparing-your-brain-data","dir":"Articles","previous_headings":"","what":"Preparing your brain data","title":"Getting ready, step 2: formatting input data","text":"obtain brain surface data, first run subjects FreeSurfer, using following command: Don’t forget -qcache flag! Full instructions can found , header “pre-smoothed fsaverage surfaces”. output folder now look similar one seen . Inside subject-session sub-folder able find “surf” directory brain surface maps hemisphere saved .mgh files. files using analysis.","code":"recon-all -s <subject-id> -qcache"},{"path":"https://seredef.github.io/verywise/articles/01-format-data.html","id":"preparing-your-phenotype-data","dir":"Articles","previous_headings":"","what":"Preparing your phenotype data","title":"Getting ready, step 2: formatting input data","text":"brain data sorted, also need prepare “phenotype” dataset store variables interest (.e. exposures covariates). can either saved file (e.g., .rds .csv), can R data.frame already loaded memory. Either way, look something like : “long format” different timepoints/groups stacked row-wise. folder_id column important used link phenotype correct brain data file. … TODO Note phenotype file/data object can also imputed dataset. verywise currently supports several mi dataset formats, including outputs mice, mi, amelia… TODO","code":""},{"path":"https://seredef.github.io/verywise/articles/02-simulate-data.html","id":"data-poor-simulate-yourself-some-data-son","dir":"Articles","previous_headings":"","what":"Data poor? Simulate yourself some data, son","title":"Optional: simulating data","text":"eager get started verywise access dataset (yet), can generate set ready-made FreeSurfer surface data files phenotype file go . simulated dataset already saved verywise structure.","code":"library(verywise) #> Welcome, verywise user! #> This is version: 1.0.0 #> For questions, issues, and bug reports, please see https://github.com/SereDef/verywise"},{"path":"https://seredef.github.io/verywise/articles/02-simulate-data.html","id":"only-generate-the-brain-data","dir":"Articles","previous_headings":"","what":"Only generate the brain data","title":"Optional: simulating data","text":"phenotype dataset already, missing FreeSurfer data, can call following function: example, going generate 500 left hemisphere (\"lh\") thickness maps. maps belong 250 fictional subjects, underwent 2 MRI sessions (\"01\" \"02\") belong two cohorts (\"cohort1\" \"cohort2\"). resolution fake surface maps 163842 vertices (corresponding detailed FreeSurfer template \"fsaverage\"), overall mean 6.5 (mm thickness) standard deviation 0.5. can also use function specify simulated association variable choice. TODO","code":"# Simulate FreeSurfer dataset my_dataset_structure = list(\"cohort1\" = list(\"sessions\" = c(\"01\", \"02\"),                                              \"n_subjects\" = 100),                             \"cohort2\" = list(\"sessions\" = c(\"01\", \"02\"),                                              \"n_subjects\" = 150)                             ) my_random_seed = 1984  simulate_freesurfer_data(path = \"./VeryWiseUser/SimulatedExample\",                          data_structure = my_dataset_structure,                          vw_resolution = 163842,                          measure = \"thickness\",                          hemi = \"lh\",                          fwhmc = \"fwhm10\",                          target = \"fsaverage\",                          vw_mean = 6.5,                          vw_sd = 0.5,                          simulate_association = NULL,                          seed = my_random_seed)"},{"path":"https://seredef.github.io/verywise/articles/02-simulate-data.html","id":"only-generate-the-phenotype-data","dir":"Articles","previous_headings":"","what":"Only generate the phenotype data","title":"Optional: simulating data","text":"hand, already surfaces like phenotype go can use: generate minimum “long format” dataframe variables need, well simulated “sex” “age” sample.","code":"# Simulate phenotype dataset simulate_long_pheno_data(data_structure = my_dataset_structure,                          seed = my_random_seed)"},{"path":"https://seredef.github.io/verywise/articles/02-simulate-data.html","id":"alright-all-in-one-go-now","dir":"Articles","previous_headings":"","what":"Alright, all in one go now","title":"Optional: simulating data","text":"call simulate_long_pheno_data() simulate_freesurfer_data() give everything need play around verywise model fitting.","code":"# Simulate FreeSurfer and phenotype dataset simulate_data(path = \"./VeryWiseUser/SimulatedExample\",                data_structure = my_dataset_structure,               simulate_association =  0.05 * pheno$age,               overwrite = TRUE,               seed = my_random_seed)"},{"path":"https://seredef.github.io/verywise/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Serena Defina. Maintainer, author. Sander Lamballais. Author. Bing Xu. Contributor. Annet Dijkzeul. Contributor. Ryan Muetzel. Contributor, funder.","code":""},{"path":"https://seredef.github.io/verywise/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Defina S, Lamballais S (2025). verywise: Vertex-wise Statistical Analysis Neuroimaging data. R package version 1.0.0, https://github.com/SereDef/verywise.","code":"@Manual{,   title = {verywise: Vertex-wise Statistical Analysis of Neuroimaging data},   author = {Serena Defina and Sander Lamballais},   year = {2025},   note = {R package version 1.0.0},   url = {https://github.com/SereDef/verywise}, }"},{"path":[]},{"path":"https://seredef.github.io/verywise/index.html","id":"vertex-wise-whole-brain-linear-mixed-models","dir":"","previous_headings":"","what":"vertex-wise, whole-brain linear mixed models","title":"Vertex-wise Statistical Analysis of Neuroimaging data","text":"goal verywise offer flexible, user-friendly interface whole-brain analysis neuro-imaging data pre-processed using FreeSurfer. package specifically designed analysis longitudinal (e.g. multi-session) /multi-site neuroimaging data. Currently, verywise allows estimation vertex-wise Linear Mixed Models, extended statistical models future. can handle imputed (phenotype) data several packages (mice, mi, amelia, etc.). Multiple testing correction currently achieved using MCZ simulations FreeSurfer. means need FreeSurfer installed correctly set .","code":""},{"path":"https://seredef.github.io/verywise/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Vertex-wise Statistical Analysis of Neuroimaging data","text":"can install development version verywise GitHub :","code":"# install.packages(\"devtools\") devtools::install_github(\"SereDef/verywise\")"},{"path":"https://seredef.github.io/verywise/index.html","id":"basic-use","dir":"","previous_headings":"","what":"Basic use","title":"Vertex-wise Statistical Analysis of Neuroimaging data","text":"can find info tutorials .","code":"library(verywise) # Run a linear mixed model run_vw_lmm(   formula = vw_thickness ~ sex * age + site + (1 | id), # model formula   subj_dir = \"./VeryWiseUserUser/SimulatedExample\", # Neuro-imaging data location   hemi = \"both\", # (default) which hemispheres to run   pheno = phenotype, # An R object already in memory or path to file  )"},{"path":"https://seredef.github.io/verywise/index.html","id":"visualization","dir":"","previous_headings":"","what":"Visualization","title":"Vertex-wise Statistical Analysis of Neuroimaging data","text":"inspect plot results can use interactive web application, verywiseWIZard. can run locally try .","code":""},{"path":"https://seredef.github.io/verywise/index.html","id":"note","dir":"","previous_headings":"","what":"Note","title":"Vertex-wise Statistical Analysis of Neuroimaging data","text":"spin-(stable) QDECR package.","code":""},{"path":"https://seredef.github.io/verywise/index.html","id":"funders","dir":"","previous_headings":"","what":"Funders","title":"Vertex-wise Statistical Analysis of Neuroimaging data","text":"work supported FLAG-ERA grant Infant2Adult Netherlands Organization Health Research Development (ZonMw, grant number 16080606). feedback contributions welcome!.","code":""},{"path":"https://seredef.github.io/verywise/reference/as.mgh.html","id":null,"dir":"Reference","previous_headings":"","what":"Create an object structured like an MGH object — as.mgh","title":"Create an object structured like an MGH object — as.mgh","text":"Create object structured like MGH object","code":""},{"path":"https://seredef.github.io/verywise/reference/as.mgh.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create an object structured like an MGH object — as.mgh","text":"","code":"as.mgh(   x,   version = 1L,   ndim1 = as.integer(length(x)),   ndim2 = 1L,   ndim3 = 1L,   nframes = 1L,   type = 3L,   dof = 0L )"},{"path":"https://seredef.github.io/verywise/reference/as.mgh.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create an object structured like an MGH object — as.mgh","text":"x vertex-wise values version Version (default = 1) ndim1 Width / 1st dimension (default = length(x)) ndim2 Height / 2nd dimension (default = 1) ndim3 Depth / 3rd dimension (default = 1) nframes Number scalar components (default = 1) type Data type, can UCHAR (0), SHORT (4), INT (1) FLOAT (3) (default = 3) dof Degrees freedom (default = 0)","code":""},{"path":"https://seredef.github.io/verywise/reference/as.mgh.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create an object structured like an MGH object — as.mgh","text":"mgh object data various header elements","code":""},{"path":"https://seredef.github.io/verywise/reference/as.mgh.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Create an object structured like an MGH object — as.mgh","text":"Sander Lamballais, 2018.","code":""},{"path":"https://seredef.github.io/verywise/reference/barnard.rubin.html","id":null,"dir":"Reference","previous_headings":"","what":"Pooled degrees of freedom calculation — barnard.rubin","title":"Pooled degrees of freedom calculation — barnard.rubin","text":"Edited mice::barnard.rubin. function computes residual degrees freedom hypothesis testing, proposed Barnard & Rubin (1999). used vw_pool function.","code":""},{"path":"https://seredef.github.io/verywise/reference/barnard.rubin.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pooled degrees of freedom calculation — barnard.rubin","text":"","code":"barnard.rubin(lambda, m, dfcom = Inf)"},{"path":"https://seredef.github.io/verywise/reference/barnard.rubin.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Pooled degrees of freedom calculation — barnard.rubin","text":"lambda : Proportion total variance due missingness m : Number imputed datasets dfcom : Residual degrees freedom, estimated using stats::df.residual()","code":""},{"path":"https://seredef.github.io/verywise/reference/barnard.rubin.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Pooled degrees of freedom calculation — barnard.rubin","text":"Value residual degrees freedom","code":""},{"path":"https://seredef.github.io/verywise/reference/barnard.rubin.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Pooled degrees of freedom calculation — barnard.rubin","text":"Barnard, J. Rubin, D.B. (1999). Small sample degrees freedom multiple imputation. Biometrika, 86, 948-955.","code":""},{"path":"https://seredef.github.io/verywise/reference/build_supersubject.html","id":null,"dir":"Reference","previous_headings":"","what":"Build ","title":"Build ","text":"Build \"supersubject\" stacking vertex data one large file-backed matrix dimensions n_subjects x n_vertices.","code":""},{"path":"https://seredef.github.io/verywise/reference/build_supersubject.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Build ","text":"","code":"build_supersubject(   subj_dir,   folder_ids,   outp_dir,   measure,   hemi,   n_cores,   fwhmc = \"fwhm10\",   fs_template = \"fsaverage\",   backing,   error_cutoff = 20,   save_rds = FALSE,   verbose = TRUE )"},{"path":"https://seredef.github.io/verywise/reference/build_supersubject.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Build ","text":"subj_dir : path FreeSurfer data, expects verywise structure. folder_ids : vector observations include. holds relative path (`subj_dir`) FreeSurfer data folder (e.g. \"site1/sub-1_ses-01\"). outp_dir : output path, logs, backing files matrix (`save_rds == TRUE`) stored. measure : vertex-wise measure, used identify files. hemi : hemisphere, used identify files. n_cores : number cores use parallel processing. fwhmc : (default = \"fwhm10\") full-width half maximum value, used identify files. fs_template : (default = \"fsaverage\") template register vertex-wise data. following values accepted:  * fsaverage (default) = 163842 vertices (highest resolution),  * fsaverage6 = 40962 vertices,  * fsaverage5 = 10242 vertices,  * fsaverage4 = 2562 vertices,  * fsaverage3 = 642 vertices Note , moment, used downsample brain map, faster model tuning. `verywise` expects input data always registered \"fsaverage\" template final analyses also run using `fs_template = \"fsaverage\"` avoid (small) imprecisions vertex registration smoothing. backing : (default = `outp_dir`) location save matrix backingfile. error_cutoff : (default = 20) many missing directories brain surface files function stop error. < `error_cutoff` directories/files found warning thrown missing files registered `issues.log` file. save_rds : (default = FALSE) save supersubject file metadata re-use sessions. verbose : (default = TRUE)","code":""},{"path":"https://seredef.github.io/verywise/reference/build_supersubject.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Build ","text":"Filebacked Big Matrix vertex data subjects (dimensions: n_subjects x n_vertices)","code":""},{"path":"https://seredef.github.io/verywise/reference/build_supersubject.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Build ","text":"Serena Defina, 2024.","code":""},{"path":"https://seredef.github.io/verywise/reference/check_pheno_obj.html","id":null,"dir":"Reference","previous_headings":"","what":"Check that object exists in the global environment — check_pheno_obj","title":"Check that object exists in the global environment — check_pheno_obj","text":"Check object exists global environment","code":""},{"path":"https://seredef.github.io/verywise/reference/check_pheno_obj.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check that object exists in the global environment — check_pheno_obj","text":"","code":"check_pheno_obj(obj_name)"},{"path":"https://seredef.github.io/verywise/reference/check_pheno_obj.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check that object exists in the global environment — check_pheno_obj","text":"obj_name character string specifying name object","code":""},{"path":"https://seredef.github.io/verywise/reference/check_pheno_obj.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check that object exists in the global environment — check_pheno_obj","text":"object global environment (exists).","code":""},{"path":"https://seredef.github.io/verywise/reference/check_pheno_obj.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Check that object exists in the global environment — check_pheno_obj","text":"function checks specified object exists global environment. returns object found, otherwise raises error message.","code":""},{"path":"https://seredef.github.io/verywise/reference/compute_clusters.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute significant clusters of vertices — compute_clusters","title":"Compute significant clusters of vertices — compute_clusters","text":"function wrapper FreeSurfer command mri_surfcluster. computes clusters significant vertices.","code":""},{"path":"https://seredef.github.io/verywise/reference/compute_clusters.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute significant clusters of vertices — compute_clusters","text":"","code":"compute_clusters(   outp_dir,   hemi,   term_number,   fwhm,   FS_HOME,   cwp_thr = 0.025,   mcz_thr = 30,   csd_sign = \"abs\",   mask = NULL,   verbose = FALSE )"},{"path":"https://seredef.github.io/verywise/reference/compute_clusters.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute significant clusters of vertices — compute_clusters","text":"outp_dir : output path, results stored. hemi : hemisphere. term_number : (fixed) term clusters computed . fwhm : full-width half maximum estimate data smoothness. FS_HOME : FreeSurfer directory, .e. $FREESURFER_HOME cwp_thr : (default = 0.025, hemispheres ran, else 0.05) cluster-wise p-value threshold top corrections. mcz_thr : (default = 0.001) numeric value Monte Carlo simulation threshold. following accepted (equivalent values separate `/`):  * 13 / 1.3 / 0.05,  * 20 / 2.0 / 0.01, . * 23 / 2.3 / 0.005,  * 30 / 3.0 / 0.001, \\* default  * 33 / 3.3 / 0.0005,  * 40 / 4.0 / 0.0001. csd_sign : (default = \"abs\") mask : apply mask (default = cortical mask + excluding problematic vertices) verbose : (default = FALSE) verbosity.","code":""},{"path":"https://seredef.github.io/verywise/reference/create_cortex_mask.html","id":null,"dir":"Reference","previous_headings":"","what":"@title Save logical cortex mask from FreeSurfer cortex.label files — create_cortex_mask","title":"@title Save logical cortex mask from FreeSurfer cortex.label files — create_cortex_mask","text":"@title Save logical cortex mask FreeSurfer cortex.label files","code":""},{"path":"https://seredef.github.io/verywise/reference/create_cortex_mask.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"@title Save logical cortex mask from FreeSurfer cortex.label files — create_cortex_mask","text":"","code":"create_cortex_mask(   freesurfer_home = \"\",   fsaverage_template = \"fsaverage\",   hemi = \"lh\",   outp_path = getwd() )"},{"path":"https://seredef.github.io/verywise/reference/create_cortex_mask.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"@title Save logical cortex mask from FreeSurfer cortex.label files — create_cortex_mask","text":"freesurfer_home : path freesurfer home fsaverage_template : one \"fsaverage\" (163842 vertices), \"fsaverage6\" (40962), \"fsaverage5\" (10242), \"fsaverage4\" (2562), \"fsaverage3\" (642) hemi : \"lh\" \"rh\" outp_path : path save logical mask","code":""},{"path":"https://seredef.github.io/verywise/reference/estimate_fwhm.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate full-width half maximum (FWHM) — estimate_fwhm","title":"Estimate full-width half maximum (FWHM) — estimate_fwhm","text":"function wrapper FreeSurfer command mris_fwhm. estimates full-width half maximum (FWHM) brain data based residuals model.","code":""},{"path":"https://seredef.github.io/verywise/reference/estimate_fwhm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate full-width half maximum (FWHM) — estimate_fwhm","text":"","code":"estimate_fwhm(   outp_dir,   hemi,   resid_file,   mask = NULL,   fs_template = \"fsaverage\",   verbose = FALSE )"},{"path":"https://seredef.github.io/verywise/reference/estimate_fwhm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate full-width half maximum (FWHM) — estimate_fwhm","text":"outp_dir : output path, results stored. function generates two files: \"fwhm.dat\" \"finamMask.mgh\". hemi : hemisphere. resid_file : path .mgh file containing residuals model. mask : apply mask (default = cortical mask + excluding problematic vertices) fs_template : (default = \"fsaverage\") data template. verbose : (default = FALSE) verbosity.","code":""},{"path":"https://seredef.github.io/verywise/reference/estimate_fwhm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate full-width half maximum (FWHM) — estimate_fwhm","text":"integer FWHM value","code":""},{"path":"https://seredef.github.io/verywise/reference/fbm2mgh.html","id":null,"dir":"Reference","previous_headings":"","what":"Save file backed matrix (FBM) to MGH file — fbm2mgh","title":"Save file backed matrix (FBM) to MGH file — fbm2mgh","text":"Save file backed matrix (FBM) MGH file","code":""},{"path":"https://seredef.github.io/verywise/reference/fbm2mgh.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Save file backed matrix (FBM) to MGH file — fbm2mgh","text":"","code":"fbm2mgh(fbm, fname, filter = NULL)"},{"path":"https://seredef.github.io/verywise/reference/fbm2mgh.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Save file backed matrix (FBM) to MGH file — fbm2mgh","text":"fbm file backed matrix fname file name used save data filter vector indices rows include fbm","code":""},{"path":"https://seredef.github.io/verywise/reference/fbm2mgh.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Save file backed matrix (FBM) to MGH file — fbm2mgh","text":"Sander Lamballais, 2018. Modified version save_mgh.m (Heath Pardoe, 09/12/2013)","code":""},{"path":"https://seredef.github.io/verywise/reference/fbm_col_has_0.html","id":null,"dir":"Reference","previous_headings":"","what":"Check if all row elements are 0 in FBM — fbm_col_has_0","title":"Check if all row elements are 0 in FBM — fbm_col_has_0","text":"Check row elements FBM 0. used clean super-subject matrix mask_cortex.","code":""},{"path":"https://seredef.github.io/verywise/reference/fbm_col_has_0.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check if all row elements are 0 in FBM — fbm_col_has_0","text":"","code":"fbm_col_has_0(   X,   n_cores = 1,   row.ind = bigstatsr::rows_along(X),   col.ind = bigstatsr::cols_along(X),   row.mask = NULL,   col.mask = NULL )"},{"path":"https://seredef.github.io/verywise/reference/fbm_col_has_0.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check if all row elements are 0 in FBM — fbm_col_has_0","text":"X : file-backed matrix (FBM) object n_cores : (default = 1) number cores parellalization row.ind : indicator rows col.ind : indicator columns row.mask : (default = NULL) specify subset rows col.mask : (default = NULL) specify subset columns","code":""},{"path":"https://seredef.github.io/verywise/reference/fbm_col_has_0.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check if all row elements are 0 in FBM — fbm_col_has_0","text":"(large) logical vector rows 0.","code":""},{"path":"https://seredef.github.io/verywise/reference/fbm_col_has_0.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Check if all row elements are 0 in FBM — fbm_col_has_0","text":"Serena Defina, 2024.","code":""},{"path":"https://seredef.github.io/verywise/reference/get_terms.html","id":null,"dir":"Reference","previous_headings":"","what":"Unpack lme4 formula — get_terms","title":"Unpack lme4 formula — get_terms","text":"Get terms fixed effect model matrix given formula dataset.","code":""},{"path":"https://seredef.github.io/verywise/reference/get_terms.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Unpack lme4 formula — get_terms","text":"","code":"get_terms(formula, data_list)"},{"path":"https://seredef.github.io/verywise/reference/get_terms.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Unpack lme4 formula — get_terms","text":"formula : model formula object (specify LME model) data_list : data, formatted list datasets, output imp2list.","code":""},{"path":"https://seredef.github.io/verywise/reference/get_terms.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Unpack lme4 formula — get_terms","text":"list two elements: fixed terms, model frame.","code":""},{"path":"https://seredef.github.io/verywise/reference/get_terms.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Unpack lme4 formula — get_terms","text":"Serena Defina, 2024.","code":""},{"path":"https://seredef.github.io/verywise/reference/hemi_vw_lmm.html","id":null,"dir":"Reference","previous_headings":"","what":"Run vertex-wise linear mixed model in one hemisphere using lme4::lmer() — hemi_vw_lmm","title":"Run vertex-wise linear mixed model in one hemisphere using lme4::lmer() — hemi_vw_lmm","text":"runs single_lmm function across vertices single hemisphere.","code":""},{"path":"https://seredef.github.io/verywise/reference/hemi_vw_lmm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run vertex-wise linear mixed model in one hemisphere using lme4::lmer() — hemi_vw_lmm","text":"","code":"hemi_vw_lmm(   formula,   data_list,   subj_dir,   outp_dir = NULL,   FS_HOME = \"\",   folder_id = \"folder_id\",   hemi,   fwhm = 10,   fs_template = \"fsaverage\",   mcz_thr = 30,   cwp_thr = 0.025,   seed = 3108,   apply_cortical_mask = TRUE,   save_ss = TRUE,   model = \"lme4::lmer\",   use_model_template = TRUE,   n_cores,   chunk_size = 1000,   verbose = TRUE )"},{"path":"https://seredef.github.io/verywise/reference/hemi_vw_lmm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run vertex-wise linear mixed model in one hemisphere using lme4::lmer() — hemi_vw_lmm","text":"formula model formula object. specify linear mixed model lme4 syntax. outcome variable one supported brain surface metrics (see Details). Example: vw_thickness ~ age * sex + site + (1|participant_id). data_list : list dataframes containing phenotype information (generated imp2list) subj_dir Character string specifying path FreeSurfer data directory. Must follow verywise directory structure (see package vignette details). outp_dir Character string specifying output directory results. NULL (default), creates \"verywise_results\" subdirectory within subj_dir. FS_HOME Character string specifying FreeSurfer home directory. Defaults FREESURFER_HOME environment variable. folder_id Character string specifying column name pheno contains subject directory names input neuroimaging data (e.g., \"sub-001_ses-baseline\" \"site1/sub-010_ses-F1\"). expected nested inside subj_dir. Default: \"folder_id\". hemi Character string specifying hemisphere(s) analyze. Options: \"\" (default), \"lh\" (left ), \"rh\" (right ). fwhm : (default = 10) full-width half maximum value fs_template Character string specifying FreeSurfer template   vertex registration. Options:  * \"fsaverage\" (default) = 163842 vertices (highest resolution),  * \"fsaverage6\" = 40962 vertices,  * \"fsaverage5\" = 10242 vertices,  * \"fsaverage4\" = 2562 vertices,  * \"fsaverage3\" = 642 vertices Note lower resolutions used downsample brain map, faster model tuning. final analyses also run using `fs_template = \"fsaverage\"` avoid (small) imprecisions vertex registration smoothing. mcz_thr : (default = 0.001) numeric value Monte Carlo simulation threshold. following accepted (equivalent values separate `/`):  * 13 / 1.3 / 0.05,  * 20 / 2.0 / 0.01,  * 23 / 2.3 / 0.005,  * 30 / 3.0 / 0.001, \\* default  * 33 / 3.3 / 0.0005,  * 40 / 4.0 / 0.0001. cwp_thr : (default = 0.025, hemispheres ran, else 0.05) cluster-wise p-value threshold top corrections. seed Integer specifying random seed reproducibility. Default: 3108. apply_cortical_mask Logical indicating whether exclude non-cortical vertices analysis. Default: TRUE (recommended). save_ss Logical indicating whether save super-subject matrix .rds file faster future processing. Default: TRUE (recommended). model : (default = \"lme4::lmer\") # \"stats::lm\" use_model_template Logical indicating whether pre-compile model template faster estimation. Default: TRUE (recommended). n_cores Integer specifying number CPU cores parallel processing. Default: 1. chunk_size Integer specifying number vertices processed per chunk parallel operations. Larger values use memory may faster. Default: 1000. verbose Logical indicating whether display progress messages. Default: TRUE.","code":""},{"path":"https://seredef.github.io/verywise/reference/hemi_vw_lmm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run vertex-wise linear mixed model in one hemisphere using lme4::lmer() — hemi_vw_lmm","text":"list file-backed matrices containing pooled coefficients, SEs, t- p- values residuals.","code":""},{"path":"https://seredef.github.io/verywise/reference/hemi_vw_lmm.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Run vertex-wise linear mixed model in one hemisphere using lme4::lmer() — hemi_vw_lmm","text":"Serena Defina, 2024.","code":""},{"path":"https://seredef.github.io/verywise/reference/imp2list.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert imputation object to a list of dataframes — imp2list","title":"Convert imputation object to a list of dataframes — imp2list","text":"Converts known imputation objects (e.g., amelia, aregImpute, mi, mids, missForest) list dataframes.","code":""},{"path":"https://seredef.github.io/verywise/reference/imp2list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert imputation object to a list of dataframes — imp2list","text":"","code":"imp2list(obj)"},{"path":"https://seredef.github.io/verywise/reference/imp2list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert imputation object to a list of dataframes — imp2list","text":"obj imputation object contains imputed datasets","code":""},{"path":"https://seredef.github.io/verywise/reference/imp2list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert imputation object to a list of dataframes — imp2list","text":"list imputed datasets","code":""},{"path":"https://seredef.github.io/verywise/reference/imp2list.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Convert imputation object to a list of dataframes — imp2list","text":"function attempts unify imputation object formats supplying datasets. done extracting imputed datasets imputation object assembling list. unknown object supplied, function throw error request supply list data frames instead. generic function: methods can defined directly, see methods(imp2list) list available methods.","code":""},{"path":"https://seredef.github.io/verywise/reference/imp2list.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Convert imputation object to a list of dataframes — imp2list","text":"Sander Lamballais, 2018.","code":""},{"path":"https://seredef.github.io/verywise/reference/list.dirs.till.html","id":null,"dir":"Reference","previous_headings":"","what":"List sub-directories till depth n — list.dirs.till","title":"List sub-directories till depth n — list.dirs.till","text":"Small recursive utility list directories given complex folder structure. used build_supersubject listing sub-directories correct level.","code":""},{"path":"https://seredef.github.io/verywise/reference/list.dirs.till.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"List sub-directories till depth n — list.dirs.till","text":"","code":"list.dirs.till(path, n)"},{"path":"https://seredef.github.io/verywise/reference/list.dirs.till.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"List sub-directories till depth n — list.dirs.till","text":"path : path begin search n : depth recursive process (.e., many levels sub-directories list)","code":""},{"path":"https://seredef.github.io/verywise/reference/list.dirs.till.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"List sub-directories till depth n — list.dirs.till","text":"list directory/sub-directory names.","code":""},{"path":"https://seredef.github.io/verywise/reference/list.dirs.till.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"List sub-directories till depth n — list.dirs.till","text":"Serena Defina, 2024.","code":""},{"path":"https://seredef.github.io/verywise/reference/load.mgh.html","id":null,"dir":"Reference","previous_headings":"","what":"Load an MGH file into memory — load.mgh","title":"Load an MGH file into memory — load.mgh","text":"Load MGH file memory","code":""},{"path":"https://seredef.github.io/verywise/reference/load.mgh.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Load an MGH file into memory — load.mgh","text":"","code":"load.mgh(file_path)"},{"path":"https://seredef.github.io/verywise/reference/load.mgh.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Load an MGH file into memory — load.mgh","text":"file_path : (full) path mgh file.","code":""},{"path":"https://seredef.github.io/verywise/reference/load.mgh.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Load an MGH file into memory — load.mgh","text":"mgh object data various header elements","code":""},{"path":"https://seredef.github.io/verywise/reference/load.mgh.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Load an MGH file into memory — load.mgh","text":"Heath Perdoe, 2013.","code":""},{"path":"https://seredef.github.io/verywise/reference/load_pheno_file.html","id":null,"dir":"Reference","previous_headings":"","what":"Load ","title":"Load ","text":"Takes path file reads memory.","code":""},{"path":"https://seredef.github.io/verywise/reference/load_pheno_file.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Load ","text":"","code":"load_pheno_file(pheno_str, verbose = TRUE)"},{"path":"https://seredef.github.io/verywise/reference/load_pheno_file.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Load ","text":"pheno_str character string specifying file path. verbose (default = TRUE).","code":""},{"path":"https://seredef.github.io/verywise/reference/load_pheno_file.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Load ","text":"data frame containing loaded data","code":""},{"path":"https://seredef.github.io/verywise/reference/load_pheno_file.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Load ","text":"function checks file exists, identifies file extension, loads data accordingly. Supported file types: .csv, .rds, .sav, .txt.","code":""},{"path":"https://seredef.github.io/verywise/reference/make_chunk_sequence.html","id":null,"dir":"Reference","previous_headings":"","what":"Define chunks of vertices for analyses — make_chunk_sequence","title":"Define chunks of vertices for analyses — make_chunk_sequence","text":"function takes vector values representing dimension vertex-wise data use splits chunks speeding parallel processing.","code":""},{"path":"https://seredef.github.io/verywise/reference/make_chunk_sequence.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Define chunks of vertices for analyses — make_chunk_sequence","text":"","code":"make_chunk_sequence(iv, chunk_size = 1000)"},{"path":"https://seredef.github.io/verywise/reference/make_chunk_sequence.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Define chunks of vertices for analyses — make_chunk_sequence","text":"iv : indices vertex-wise brain data use. chunk_size : (default = 1000) big chunks","code":""},{"path":"https://seredef.github.io/verywise/reference/make_chunk_sequence.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Define chunks of vertices for analyses — make_chunk_sequence","text":"matrix n_chunks rows 2 columns (chunk start end positions).","code":""},{"path":"https://seredef.github.io/verywise/reference/make_chunk_sequence.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Define chunks of vertices for analyses — make_chunk_sequence","text":"Serena Defina, 2024.","code":""},{"path":"https://seredef.github.io/verywise/reference/mask_cortex.html","id":null,"dir":"Reference","previous_headings":"","what":"Clean out vertices that are not on the cortex — mask_cortex","title":"Clean out vertices that are not on the cortex — mask_cortex","text":"Clean super-subject matrix vertices 0 value located cortex, according FreeSurfer *cortical.mask.mgh file distributed inst/extdata. function used build_supersubject.","code":""},{"path":"https://seredef.github.io/verywise/reference/mask_cortex.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Clean out vertices that are not on the cortex — mask_cortex","text":"","code":"mask_cortex(hemi = \"lh\", fs_template = \"fsaverage\")"},{"path":"https://seredef.github.io/verywise/reference/mask_cortex.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Clean out vertices that are not on the cortex — mask_cortex","text":"hemi : (default = \"lh\") hemisphere (\"lh\" \"rh\") fs_template : (default = \"fsaverage\")","code":""},{"path":"https://seredef.github.io/verywise/reference/mask_cortex.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Clean out vertices that are not on the cortex — mask_cortex","text":"(large) logical vector cortical (technical, .e. vertex = 0) mask.","code":""},{"path":"https://seredef.github.io/verywise/reference/pipe.html","id":null,"dir":"Reference","previous_headings":"","what":"Pipe operator — %>%","title":"Pipe operator — %>%","text":"See magrittr::%>% details.","code":""},{"path":"https://seredef.github.io/verywise/reference/pipe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pipe operator — %>%","text":"","code":"lhs %>% rhs"},{"path":"https://seredef.github.io/verywise/reference/pipe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Pipe operator — %>%","text":"lhs value magrittr placeholder. rhs function call using magrittr semantics.","code":""},{"path":"https://seredef.github.io/verywise/reference/pipe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Pipe operator — %>%","text":"result calling `rhs(lhs)`.","code":""},{"path":"https://seredef.github.io/verywise/reference/pretty_message.html","id":null,"dir":"Reference","previous_headings":"","what":"Print pretty messages to console — pretty_message","title":"Print pretty messages to console — pretty_message","text":"Adds fillers messages","code":""},{"path":"https://seredef.github.io/verywise/reference/pretty_message.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print pretty messages to console — pretty_message","text":"","code":"pretty_message(content, fill = \"=\", tot_nchar = 60, center = TRUE)"},{"path":"https://seredef.github.io/verywise/reference/pretty_message.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print pretty messages to console — pretty_message","text":"content : message print fill : (default \"=\") tot_nchar : (default: 60) center : (default: TRUE) center content.","code":""},{"path":"https://seredef.github.io/verywise/reference/pretty_message.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print pretty messages to console — pretty_message","text":"prettyfyed console message.","code":""},{"path":"https://seredef.github.io/verywise/reference/pretty_message.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Print pretty messages to console — pretty_message","text":"Serena Defina, 2025.","code":""},{"path":"https://seredef.github.io/verywise/reference/run_vw_lmm.html","id":null,"dir":"Reference","previous_headings":"","what":"Run vertex-wise linear mixed model using lme4::lmer() — run_vw_lmm","title":"Run vertex-wise linear mixed model using lme4::lmer() — run_vw_lmm","text":"main function conducting vertex-wise linear mixed model analyses brain surface metrics. first check use inputs, prepare phenotype data(list) run linear mixed model specified hemispheres using hemi_vw_lmm function. function supports analysis single multiple imputed datasets. also automatically handles cortical masking, provides cluster-wise correction multiple testing using FreeSurfer's Monte Carlo simulation approach.","code":""},{"path":"https://seredef.github.io/verywise/reference/run_vw_lmm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run vertex-wise linear mixed model using lme4::lmer() — run_vw_lmm","text":"","code":"run_vw_lmm(   formula,   pheno,   subj_dir,   outp_dir = NULL,   hemi = c(\"both\", \"lh\", \"rh\"),   folder_id = \"folder_id\",   seed = 3108,   n_cores = 1,   chunk_size = 1000,   FS_HOME = Sys.getenv(\"FREESURFER_HOME\"),   fs_template = \"fsaverage\",   apply_cortical_mask = TRUE,   use_model_template = TRUE,   save_ss = TRUE,   verbose = TRUE,   ... )"},{"path":"https://seredef.github.io/verywise/reference/run_vw_lmm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run vertex-wise linear mixed model using lme4::lmer() — run_vw_lmm","text":"formula model formula object. specify linear mixed model lme4 syntax. outcome variable one supported brain surface metrics (see Details). Example: vw_thickness ~ age * sex + site + (1|participant_id). pheno Either `data.frame`/`tibble` containing \"phenotype\" data (.e., already loaded global environment), string specifying file path phenotype data. Supported file formats: .rds, .csv, .txt, .sav (SPSS). data **long** format contain variables specified formula plus folder_id column. subj_dir Character string specifying path FreeSurfer data directory. Must follow verywise directory structure (see package vignette details). outp_dir Character string specifying output directory results. NULL (default), creates \"verywise_results\" subdirectory within subj_dir. hemi Character string specifying hemisphere(s) analyze. Options: \"\" (default), \"lh\" (left ), \"rh\" (right ). folder_id Character string specifying column name pheno contains subject directory names input neuroimaging data (e.g., \"sub-001_ses-baseline\" \"site1/sub-010_ses-F1\"). expected nested inside subj_dir. Default: \"folder_id\". seed Integer specifying random seed reproducibility. Default: 3108. n_cores Integer specifying number CPU cores parallel processing. Default: 1. chunk_size Integer specifying number vertices processed per chunk parallel operations. Larger values use memory may faster. Default: 1000. FS_HOME Character string specifying FreeSurfer home directory. Defaults FREESURFER_HOME environment variable. fs_template Character string specifying FreeSurfer template   vertex registration. Options:  * \"fsaverage\" (default) = 163842 vertices (highest resolution),  * \"fsaverage6\" = 40962 vertices,  * \"fsaverage5\" = 10242 vertices,  * \"fsaverage4\" = 2562 vertices,  * \"fsaverage3\" = 642 vertices Note lower resolutions used downsample brain map, faster model tuning. final analyses also run using `fs_template = \"fsaverage\"` avoid (small) imprecisions vertex registration smoothing. apply_cortical_mask Logical indicating whether exclude non-cortical vertices analysis. Default: TRUE (recommended). use_model_template Logical indicating whether pre-compile model template faster estimation. Default: TRUE (recommended). save_ss Logical indicating whether save super-subject matrix .rds file faster future processing. Default: TRUE (recommended). verbose Logical indicating whether display progress messages. Default: TRUE. ... Additional arguments passed hemi_vw_lmm, including e.g., fwhm (smoothing kernel size) model (statistical model type).","code":""},{"path":"https://seredef.github.io/verywise/reference/run_vw_lmm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run vertex-wise linear mixed model using lme4::lmer() — run_vw_lmm","text":"list file-backed matrices containing pooled coefficients, SEs, t- p- values residuals.","code":""},{"path":"https://seredef.github.io/verywise/reference/run_vw_lmm.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Run vertex-wise linear mixed model using lme4::lmer() — run_vw_lmm","text":"Supported Brain Surface Metrics: *outcome* specified `formula` brain surface metric among: vw_thickness - Cortical thickness vw_area - Cortical surface area (white  surface) vw_area.pial - Cortical surface area (pial surface) vw_curv - Mean curvature vw_jacobian_white - Jacobian determinant (white surface) vw_pial - Pial surface coordinates vw_pial_lgi - Local gyrification index (pial surface) vw_sulc - Sulcal depth vw_volume - Gray matter volume vw_w_g.pct - White/gray matter intensity ratio vw_white.H - Mean curvature (white surface) vw_white.K - Gaussian curvature (white surface) Statistical Approach: function uses lme4::lmer() mixed-effects modeling, enabling analysis longitudinal hierarchical data. P-values computed using t--z approximation, cluster-wise correction applied using FreeSurfer's Monte Carlo simulation approach. Multiple Imputation: function automatically detects handles multiple imputed datasets (created mice similar packages), pooling results according Rubin's rules. Parallel processing: verywise package employs carefully designed parallelization strategy maximize computational efficiency avoiding performance penalties associated nested parallelization. Therefore, `hemi = ''`, left right cortical hemispheres processed sequentially. Within hemisphere, vertices divided chunks size chunk_size processed parallel across n_cores workers (n_cores > 1). multiple imputed datasets present, processed sequentially within vertex. Note , systems, implicit parallelism low-level matrix algebra libraries (BLAS/LAPACK) can interfere explicit parallelization. feel like processing taking long, recommend disabling implicit threading libraries starting R. example: Output Files: Results saved FreeSurfer-compatible .mgh format visualization [verywiseWIZard](https://github.com/SereDef/verywise-wizard), FreeView neuroimaging software.","code":"export OPENBLAS_NUM_THREADS=1 export OMP_NUM_THREADS=1 export MKL_NUM_THREADS=1 export VECLIB_MAXIMUM_THREADS=1 export NUMEXPR_NUM_THREADS=1"},{"path":"https://seredef.github.io/verywise/reference/run_vw_lmm.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Run vertex-wise linear mixed model using lme4::lmer() — run_vw_lmm","text":"Serena Defina, 2024.","code":""},{"path":"https://seredef.github.io/verywise/reference/run_vw_meta.html","id":null,"dir":"Reference","previous_headings":"","what":"Vertex-wise Random-Effects Meta-Analysis Across Studies — run_vw_meta","title":"Vertex-wise Random-Effects Meta-Analysis Across Studies — run_vw_meta","text":"function runs vertex-wise random-effects meta-analysis across multiple studies (sites cohorts). expects individual study results outputted `verywise::run_vw_lmm` `QDECR`.","code":""},{"path":"https://seredef.github.io/verywise/reference/run_vw_meta.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Vertex-wise Random-Effects Meta-Analysis Across Studies — run_vw_meta","text":"","code":"run_vw_meta(   stack,   hemi,   result_dirs,   study_names,   fs_template = \"fsaverage\",   n_cores = 1,   verbose = TRUE )"},{"path":"https://seredef.github.io/verywise/reference/run_vw_meta.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Vertex-wise Random-Effects Meta-Analysis Across Studies — run_vw_meta","text":"stack : Character numeric identifier fixed term meta-analyise. hemi : Character string, hemisphere analyze (`\"lh\"` `\"rh\"`). result_dirs : Character vector directories containing results files study. study_names : Character vector study names (must match length result_dirs). fs_template : Character string specifying FreeSurfer template surface. following values accepted:  * fsaverage (default) = 163842 vertices (highest resolution),  * fsaverage6 = 40962 vertices,  * fsaverage5 = 10242 vertices,  * fsaverage4 = 2562 vertices,  * fsaverage3 = 642 vertices n_cores : Integer, number CPU cores use parallel processing (default: 1). verbose : Logical, verbose execution (default: TRUE)","code":""},{"path":"https://seredef.github.io/verywise/reference/run_vw_meta.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Vertex-wise Random-Effects Meta-Analysis Across Studies — run_vw_meta","text":"named list three FBM objects: coef Meta-analytic effect size estimates vertex. se Meta-analytic standard errors vertex. p Meta-analytic p-values vertex. Additionally, exported MGH files working directory.","code":""},{"path":"https://seredef.github.io/verywise/reference/run_vw_meta.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Vertex-wise Random-Effects Meta-Analysis Across Studies — run_vw_meta","text":"vertex, function loads effect size standard error study, computes variance, runs random-effects meta-analysis using rma. Results saved Filebacked Big Matrices (FBM) MGH files downstream neuroimaging analysis.","code":""},{"path":[]},{"path":"https://seredef.github.io/verywise/reference/run_vw_meta.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Vertex-wise Random-Effects Meta-Analysis Across Studies — run_vw_meta","text":"","code":"if (FALSE) { # \\dontrun{ run_vw_meta(   stack = 1,   hemi = \"lh\",   result_dirs = c(\"study1/results\", \"study2/results\"),   study_names = c(\"Study1\", \"Study2\"),   fs_template = \"fsaverage\",   n_cores = 4 ) } # }"},{"path":"https://seredef.github.io/verywise/reference/save.mgh.html","id":null,"dir":"Reference","previous_headings":"","what":"Save an MGH file from memory — save.mgh","title":"Save an MGH file from memory — save.mgh","text":"R translation save_mgh.m (Heath Pardoe, 09/12/2013)","code":""},{"path":"https://seredef.github.io/verywise/reference/save.mgh.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Save an MGH file from memory — save.mgh","text":"","code":"save.mgh(vol, file_name)"},{"path":"https://seredef.github.io/verywise/reference/save.mgh.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Save an MGH file from memory — save.mgh","text":"vol MGH object (load.mgh) file_name File name used save data","code":""},{"path":"https://seredef.github.io/verywise/reference/save.mgh.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Save an MGH file from memory — save.mgh","text":"Sander Lamballais, 2018.","code":""},{"path":"https://seredef.github.io/verywise/reference/simulate_dataset.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate a dataset including phenotype and FreeSurfer data — simulate_dataset","title":"Simulate a dataset including phenotype and FreeSurfer data — simulate_dataset","text":"Simulating dataset multiple cohorts/sites multiple timepoints/sessions. generates: pheno data.frame participant sex age mock-data, saved \"phenotype.csv\" file path directory. FreeSurfer data saved .mgh files organised verywise folder structure.","code":""},{"path":"https://seredef.github.io/verywise/reference/simulate_dataset.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate a dataset including phenotype and FreeSurfer data — simulate_dataset","text":"","code":"simulate_dataset(   path,   data_structure = list(cohort1 = list(sessions = c(\"01\", \"02\", \"03\"), n_subjects = 10),     cohort2 = list(sessions = c(\"01\", \"02\"), n_subjects = 20)),   simulate_association = 0.05 * pheno$age,   overwrite = TRUE,   seed = 31081996,   ... )"},{"path":"https://seredef.github.io/verywise/reference/simulate_dataset.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate a dataset including phenotype and FreeSurfer data — simulate_dataset","text":"path dataset created. data_structure nested list, top level determining cohort/ dataset/site. site list two items: \"sessions\": vector session names/numbers; \"n_subjects\": integer indicating number subjects. simulate_association (default = NULL) simulate association format beta * variable. default isolated three regions: superior temporal gyrus, precentral gyrus middle temporal gyrus. overwrite (default = TRUE) whether phenotype file overwitten. seed (default = 31081996) seed used randomization. ... arguments passed simulate_freesurfer_data","code":""},{"path":[]},{"path":"https://seredef.github.io/verywise/reference/simulate_dataset.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Simulate a dataset including phenotype and FreeSurfer data — simulate_dataset","text":"Serena Defina, 2024.","code":""},{"path":"https://seredef.github.io/verywise/reference/simulate_freesurfer_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate FreeSurfer data — simulate_freesurfer_data","title":"Simulate FreeSurfer data — simulate_freesurfer_data","text":"Simulating FreeSurfer data multiple cohorts/sites multiple timepoints/sessions. function emulates folder structure output obtained calling FreeSurfer recon_all command. follows folder names \"sub-\", participant ID, \"_ses-\", session ID.","code":""},{"path":"https://seredef.github.io/verywise/reference/simulate_freesurfer_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate FreeSurfer data — simulate_freesurfer_data","text":"","code":"simulate_freesurfer_data(   path,   data_structure = list(cohort1 = list(sessions = c(\"01\", \"02\"), n_subjects = 100),     cohort2 = list(sessions = c(\"01\", \"02\"), n_subjects = 150)),   vw_resolution = 163842,   measure = \"thickness\",   hemi = \"lh\",   fwhmc = \"fwhm10\",   target = \"fsaverage\",   vw_mean = 6.5,   vw_sd = 0.5,   simulate_association = NULL,   seed = 31081996 )"},{"path":"https://seredef.github.io/verywise/reference/simulate_freesurfer_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate FreeSurfer data — simulate_freesurfer_data","text":"path data created. data_structure nested list, top level determining cohort/ dataset/site. site list two items: \"sessions\": vector session names/numbers; \"n_subjects\": integer indicating number subjects. vw_resolution (default = 163842) data dimension (many vertices) measure (default = \"thickness\"), measure, used file names. hemi (default = \"lh\") hemisphere, used file names. fwhmc (default = \"fwhm10\") full-width half maximum value, used file names. target (default = \"fsaverage\"), used file names. vw_mean (default = 6.5) mean simulated vertex-wise data. vw_sd (default = 0.5) standard deviation simulated vertex-wise data. simulate_association (default = NULL) simulate association format beta * variable. default isolated three regions: superior temporal gyrus, precentral gyrus middle temporal gyrus. seed (default = 31081996) seed used randomization.","code":""},{"path":"https://seredef.github.io/verywise/reference/simulate_freesurfer_data.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Simulate FreeSurfer data — simulate_freesurfer_data","text":"Serena Defina, 2024.","code":""},{"path":"https://seredef.github.io/verywise/reference/simulate_long_pheno_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate phenotype data — simulate_long_pheno_data","title":"Simulate phenotype data — simulate_long_pheno_data","text":"Simulating phenotype data (long format) multiple cohorts/sites multiple timepoints/sessions.","code":""},{"path":"https://seredef.github.io/verywise/reference/simulate_long_pheno_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate phenotype data — simulate_long_pheno_data","text":"","code":"simulate_long_pheno_data(   data_structure = list(cohort1 = list(sessions = c(\"01\", \"02\"), n_subjects = 100),     cohort2 = list(sessions = c(\"01\", \"02\"), n_subjects = 150)),   seed = 31081996 )"},{"path":"https://seredef.github.io/verywise/reference/simulate_long_pheno_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate phenotype data — simulate_long_pheno_data","text":"data_structure nested list, top level determining cohort/ dataset/site. site list two items: \"sessions\": vector session names/numbers; \"n_subjects\": integer indicating number subjects. seed (default = 31081996) seed used randomization.","code":""},{"path":"https://seredef.github.io/verywise/reference/simulate_long_pheno_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate phenotype data — simulate_long_pheno_data","text":"dataframe (long format) id, sex age data.","code":""},{"path":"https://seredef.github.io/verywise/reference/simulate_long_pheno_data.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Simulate phenotype data — simulate_long_pheno_data","text":"Serena Defina, 2024.","code":""},{"path":"https://seredef.github.io/verywise/reference/single_lmm.html","id":null,"dir":"Reference","previous_headings":"","what":"Run a single lme4::lmer model and extract stats — single_lmm","title":"Run a single lme4::lmer model and extract stats — single_lmm","text":"Run single lme4::lmer model extract stats","code":""},{"path":"https://seredef.github.io/verywise/reference/single_lmm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run a single lme4::lmer model and extract stats — single_lmm","text":"","code":"single_lmm(imp, y, formula, model_template = NULL, pvalues = TRUE)"},{"path":"https://seredef.github.io/verywise/reference/single_lmm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run a single lme4::lmer model and extract stats — single_lmm","text":"imp : phenotype dataset (verywise format). y : vector outcome values (.e. single vertex supersubject matrix). formula : R formula describing linear mixed model (using lme4 notation) model_template : (default = NULL) `single_lmm` can leverage \"update\"-based workflow minimize repeated parsing model construction overhead. pvalues : (default : TRUE) whether include p-values computed using *t--z* approach (see Details).","code":""},{"path":"https://seredef.github.io/verywise/reference/single_lmm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run a single lme4::lmer model and extract stats — single_lmm","text":"list two elements: \"stats\": dataframe estimates, SEs p-values fixed effect term) \"resid\": vector residuals given model.","code":""},{"path":"https://seredef.github.io/verywise/reference/single_lmm.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Run a single lme4::lmer model and extract stats — single_lmm","text":"additional parameters currently passed lme4::lmer call P-values estimated using *t--z* approach moment. known anti-conservative small sample sizes. However preferred relatively lenient (computationally inexpensive) solution stage. addressing Type error mores strictly cluster forming stage.","code":""},{"path":"https://seredef.github.io/verywise/reference/vw_message.html","id":null,"dir":"Reference","previous_headings":"","what":"Print message to console if verbose = TRUE — vw_message","title":"Print message to console if verbose = TRUE — vw_message","text":"Print message console verbose = TRUE","code":""},{"path":"https://seredef.github.io/verywise/reference/vw_message.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print message to console if verbose = TRUE — vw_message","text":"","code":"vw_message(..., verbose = TRUE)"},{"path":"https://seredef.github.io/verywise/reference/vw_message.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print message to console if verbose = TRUE — vw_message","text":"... : content print verbose (default = TRUE)","code":""},{"path":"https://seredef.github.io/verywise/reference/vw_pool.html","id":null,"dir":"Reference","previous_headings":"","what":"Pool lme4::lmer model output across imputed datasets — vw_pool","title":"Pool lme4::lmer model output across imputed datasets — vw_pool","text":"function combines estimates, standard errors p-values across imputed datasets, single model (.g., one vertex). function largely taken mice::pool() mice::summary.mipo() code. averages estimates complete data model, computes relevant statistics, following Rubin's rules (Rubin, 1987, p. 76). P-values estimated using *t--z* approach moment. known anti-conservative small sample sizes. However preferred relatively lenient (computationally inexpensive) solution stage. addressing Type error mores strictly cluster forming stage. residuals model currently simply averaged across imputed datasets, lack better idea combine .","code":""},{"path":"https://seredef.github.io/verywise/reference/vw_pool.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pool lme4::lmer model output across imputed datasets — vw_pool","text":"","code":"vw_pool(out_stats, m)"},{"path":"https://seredef.github.io/verywise/reference/vw_pool.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Pool lme4::lmer model output across imputed datasets — vw_pool","text":"out_stats : Output single_lmm, .e.: list two elements: \"stats\": dataframe estimates, SEs p-values fixed effect term) \"resid\": vector residuals given model. m : Number imputed dataset (avoid recomputing )","code":""},{"path":"https://seredef.github.io/verywise/reference/vw_pool.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Pool lme4::lmer model output across imputed datasets — vw_pool","text":"list containing pooled coefficients, SEs, t- p- values.","code":""},{"path":"https://seredef.github.io/verywise/reference/vw_pool.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Pool lme4::lmer model output across imputed datasets — vw_pool","text":"Used inside hemi_vw_lmm.","code":""},{"path":"https://seredef.github.io/verywise/reference/vw_pool.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Pool lme4::lmer model output across imputed datasets — vw_pool","text":"Rubin, D.B. (1987). Multiple Imputation Nonresponse Surveys. New York: John Wiley Sons.","code":""},{"path":"https://seredef.github.io/verywise/reference/vw_pool.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Pool lme4::lmer model output across imputed datasets — vw_pool","text":"Serena Defina, 2024.","code":""}]
